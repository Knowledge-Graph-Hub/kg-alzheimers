# Title
Conditional and joint multiple-SNP analysis of GWAS summary statistics identifies additional variants influencing complex traits

# Abstract
We present an approximate conditional and joint association analysis that can use summary-level statistics from a meta-analysis of genome-wide association studies (GWAS) and estimated linkage disequilibrium (LD) from a reference sample with individual-level genotype data. Using this method, we analyzed meta-analysis summary data from the GIANT Consortium for height and body mass index (BMI), with the LD structure estimated from genotype data in two independent cohorts. We identified 36 loci with multiple associated variants for height (38 leading and 49 additional SNPs, 87 in total) via a genome-wide SNP selection procedure. The 49 new SNPs explain approximately 1.3% of variance, nearly doubling the heritability explained at the 36 loci. We did not find any locus showing multiple associated SNPs for BMI. The method we present is computationally fast and is also applicable to case-control data, which we demonstrate in an example from meta-analysis of type 2 diabetes by the DIAGRAM Consortium.

## RESULTS
Using summary statistics (effect size, standard error and allele frequency) of ~2.5 million SNPs from the GIANT meta-analysis of 133,653 individuals for height 3 and 123,865 individuals for BMI 4 along with SNP LD estimated in 6,654 unrelated European-Americans selected from the Atherosclerosis Risk in Communities (ARIC) study (Online Methods), we identified 247 jointly associated SNPs for height and 33 for BMI with P < 5 × 10 –8 ( Supplementary Tables 1–3 ). For the convenience of presentation and the summary of results, we define a locus as a chromosomal region at which adjacent pairs of associated SNPs are less than 1 Mb distant, and we define alleles of two SNPs to be positively (negatively) correlated if their disequilibrium parameter D is positive (negative) 13 . Of the 247 SNPs associated with height, 87 at 36 loci represent multiple associated SNPs within a single locus ( Table 1 and Supplementary Tables 1 and 2 ), and all 36 loci are located in the genomic regions known to be associated with height 3 . We did not find any locus with multiple associated SNPs for BMI ( Supplementary Tables 1 and 3 ). For most of the height-associated loci, multiple associated variants were detected, mainly because of their very low LD ( r 2 < 0.01), despite their relatively close physical proximity ( Table 1 ). In this case, the effect sizes from a joint analysis were little different from those from single-SNP analyses. For some loci, SNPs were in modest LD and their increasing alleles were positively correlated. One example of this is the rs17720281 and rs7689420 SNP pair at the HHIP locus on chromosome 4 ( Table 1 ), where effect sizes for these SNPs were therefore overestimated in single-SNP analyses. In the joint analysis, although the joint effects were smaller compared to the marginal effects, these SNPs still reached genome-wide significance, and the variance explained by them collectively was larger than that if we only considered the leading SNP at that locus. For the loci at which the increasing alleles of at least two SNPs were negatively correlated, the SNP effects were underestimated in single-SNP analyses, meaning that some associated variants may be undetected. In other words, the joint analysis is more powerful than the single-SNP analysis in detecting such SNPs 7 , 8 . For example, rs1367226 at the EFEMP1 locus on chromosome 2 ( P value from the single-SNP meta-analysis ( P M ) = 0.198) and rs6784185 at the IGF2BP2 locus on chromosome 3 P M = 0.088) did not even show nominally significant association in single-SNP analyses, but they both reached genome-wide significance when fitted jointly with the leading SNPs at these two loci ( Table 1 ). At the same time, the significance and effect sizes of the leading SNPs at the two loci also increased where P M = 1.1 × 10 –28 versus the P value from the joint analysis ( P J ) = 3.0 × 10 –37 for rs3791675 and P M = 1.8 × 10 –14 versus P J = 1.5 × 10 –22 for rs720390 ( Table 1 ). There were 11 loci harboring more than 2 associated SNPs, with a maximum number of 4, and the length of each locus varied substantially. For examples, three associated SNPs at a locus on chromosome 1 covered a genomic region of 1,134 kb, and the ACAN locus on chromosome 15, with three associated SNPs, only has a length of 32 kb ( Table 1 ). Only considering the leading SNP(s) at each of the 36 loci ( Table 1 ), there were 38 leading SNPs that, in total, explained 2.5% of phenotypic variance. However, taking all 87 jointly associated SNPs into account (38 leading and 49 additional), 4.1% of variance was explained, with the additional 49 SNPs explaining an additional 1.6% of the variance.

We extracted the GIANT summary statistics of the 247 associated SNPs and performed a joint analysis of these SNPs with their LD estimated in 3,924 unrelated Australians of British Isles ancestry 14 selected from a GWAS cohort at the Queensland Institute of Medical Research (QIMR) (Online Methods). The allele frequencies of the 247 SNPs estimated from either the ARIC or the QIMR cohort were consistent with those reported by the GIANT meta-analysis ( Supplementary Fig. 1 ). The joint effects and their corresponding P values, obtained from the joint analysis using the ARIC cohort as a reference sample, showed good agreement with those obtained using the QIMR cohort as the reference sample ( Supplementary Fig. 2 and Supplementary Table 2 ), suggesting that the results are robust with respect to the choice of reference sample.

We created two predictors in the QIMR cohort by PLINK 15 , one based on all 87 multiple associated SNPs and the other based on the 49 additionally associated SNPs only, with SNP effects estimated from the joint analysis using the ARIC cohort as a reference sample, and then regressed the observed height phenotypes on the predictors. We performed the same prediction analysis in the ARIC cohort but with SNP effects estimated from the joint analysis using the QIMR cohort as the reference sample, acknowledging that the ARIC cohort is part of the discovery sample of the GIANT meta-analysis. The regression slopes were not significantly different from 1 ( Table 2 ), suggesting that the estimates of joint SNP effects are unbiased, the prediction R 2 of all 87 SNPs was ~3.8–4.8%, consistent with the estimate of 4.1% of variance explained in the discovery sample, and the prediction R 2 of the 49 additional associated SNPs was ~1.3–1.5%, in line with the estimate of 1.6% of variance explained by these SNPs in the discovery sample. Hence, by performing a prediction analysis in an independent sample, we confirmed that the 49 additional associated variants explain approximately 1.3% of phenotypic variation.

The GIANT Consortium performed a conditional meta-analysis for height 3 in a subset of stage 1 studies including 106,336 individuals and identified 19 secondary signals at 19 loci at P < 3.3 × 10 –7 . The GIANT conditional meta-analysis only reported one secondary signal at each of the 19 loci, because it was too time-consuming to conduct a single run of the conditional meta-analysis to take the process further. There are 16 loci associated with height that were reported by GIANT 3 with secondary SNPs at P < 5 × 10 –8 , all of which overlapped with our set of 36 loci with multiple associated SNPs. The concordance of these results provides a technical replication of the analysis methods.

The GIANT meta-analysis identified 180 loci that were associated with height 3 . When we fitted all 180 hit SNPs simultaneously in a joint analysis, the majority of them seemed to be independently associated, because they had been deliberately selected to be at least 1 Mb away from each other to render them unlikely to be in strong LD. However, there was an exception. Two SNPs, rs1814175 and rs5017948, were reported as independently associated SNPs by the GIANT Consortium 3 with P values in the discovery set of 1.9 × 10 –8 and 4.6 × 10 –8 , respectively ( Table 3 ). These SNPs are ~1.76 Mb distant but in substantial LD ( r = 0.61 and 0.59 in the ARIC and QIMR cohorts, respectively), suggesting that, in some specific cases, the commonly used 1-Mb window is not big enough to guarantee that two SNPs are independently associated with a trait and that the stepwise conditional analysis is a more general approach to refine association signals and to identify additional associated SNPs. Given either of these SNPs in the model, the other SNP is not found to reach genome-wide significance with P J > 0.001 ( Table 3 ). In our conditional and joint analysis, only the rs1814175 SNP was selected, and no additional signals were detected in this region.

Our method is applicable to case-control studies (Online Methods). We demonstrate this by using the summary-level statistics of the DIAGRAM meta-analysis for T2D from a discovery set of 8,130 affected individuals (cases) and 38,987 controls. In our example analysis, we focused only on the CDKN2B region, where there was some previous evidence of multiple signals 16 . We analyzed the DIAGRAM meta-analysis data, with allele frequencies and LD structure estimated from the ARIC cohort, and replicated the findings by a joint analysis using the QIMR cohort as reference sample. Two SNPs, rs10965250 and rs10757282, which are only 700 bp apart, were retained in stepwise model selection as jointly associated SNPs with P < 5 × 10 –12 , using either the ARIC or QIMR cohort as a reference sample for LD ( Table 4 ), consistent with the result from a previous analysis that the two SNPs define a haplotype association 16 . The risk alleles of these two SNPs are negatively correlated ( r = –0.53 and –0.59 in the ARIC and QIMR cohorts, respectively); therefore, the secondary SNP (rs10757282; P M = 3.1 × 10 –4 ) was masked by the primary SNP (rs10965250; P M = 1.0 × 10 –10 ) in single-SNP analyses. When they were fitted jointly, their effects, as well as statistical significance, were substantially increased compared to what was obtained in single-SNP analyses.

## DISCUSSION
We have presented a method of approximate conditional and joint genome-wide association analysis that is powerful, versatile and computationally fast. The method does not require any additional genotyping or phenotyping and does not rely on individual-level genotype and phenotype data, except for a reference population with individual genotypes—either from one of the participating studies of the meta-analysis or from genotype data in the public domain—that is required for LD estimation. The effect sizes of most SNPs that are associated with complex traits are very small, such that there is a great benefit in using estimates from a large-scale meta-analysis, and a reasonably large reference sample is sufficient to estimate LD between SNPs located near to one another. We believe that this method is useful to refine independent GWAS associations and to identify additional associated variants in large-scale meta-analysis where the pooled individual-level genotype data are unavailable for analysis.

The method is built upon the assumption that the reference sample is from the same population as the samples from which the genotype-phenotype associations are estimated, meaning that the LD correlations that are estimated from the reference sample are unbiased. We show by simulation ( Supplementary Note ) that the P values from our approximate approach are highly consistent with those from the conditional meta-analysis (correlation of >0.99 in 1,000 simulation replicates), given a reference sample of 6,654 individuals ( Supplementary Fig. 3 and Supplementary Table 4 ). The simulation results did not change if the reference sample was independent of the discovery sample, as long as both were sampled from the same general population ( Supplementary Fig. 4 ). We recommend that a reference sample be chosen with a large sample size, so that the LD correlations are estimated with little error 17 . The simulation results indicate that a reference sample with a size of at least 2,000 is required and that little additional accuracy is gained beyond a sample size of 5,000 ( Supplementary Fig. 4 ). The reference sample needs to be checked for cryptic relatedness and population stratification, which could cause correlations between SNPs that do not exist in the discovery set. In the present study, we included only the individuals of European descent in the ARIC cohort 18 and of British Isles descent in the QIMR cohort 14 and removed one of each pair of individuals with a SNP-derived relatedness estimate of >0.025 in both cohorts (Online Methods). If the expected value of the LD correlation between two SNPs is zero in the general population, the sampling variance of an observed LD correlation in a sample is proportional to the sample size ( m ), with var[ r | E( r ) = 0] = 1 / m . Thus, given a random sample of 6,654 unrelated individuals from the population, the probability of observing a LD correlation greater than 0.1 or smaller than –0.1 ( r 2 > 0.01) is 3.4 × 10 –16 . In order to investigate possible false positives resulting from errors in LD estimation, we first performed the analysis using the ARIC cohort as a reference sample, and we then performed a joint analysis of the selected SNPs using the QIMR cohort as a reference sample ( Supplementary Tables 2 and 3 ). We show that the LD correlations between adjacent pairs of the 247 height-associated SNPs are in very good agreement across the ARIC and QIMR cohorts ( Supplementary Fig. 5 ). Therefore, our main results were unlikely to be driven by errors in estimating the LD structure in the reference sample. This is consistent with our technical replication of all secondary signals reported by the GIANT Consortium from conditional analysis using individual-level genotype and phenotype data 3 . We reported most results based on the ARIC cohort (for example, Table 1 ) because it has a larger sample size and is more genetically similar to the whole GIANT meta-analysis sample relative to the QIMR cohort, where ancestry is restricted to the British Isles 14 . We could also only consider results that were consistent using two independent cohorts as reference samples. However, this might be too conservative, as some real associations identified using one cohort with P values that just passed the arbitrary cutoff value of 5 × 10 –8 , might be eliminated from the analysis in another cohort due to random errors in the estimates of LD correlations. Our method is not limited to meta-analysis summary data but can also be applied to a single GWAS cohort with individual-level genotypes, in which case, the whole discovery sample is used as the reference sample, and our method then becomes equivalent to a multiple regression analysis (Online Methods and Supplementary Fig. 6 ). In this case, the automated stepwise selection procedure implemented in our software tool 19 , which has, to our knowledge, not been implemented in any other GWAS analysis tools in the public domain, would still be useful for data applications.

As with any fixed-effect model selection strategy, such as stepwise linear multiple regression analysis, there is a risk of over-fitting effects. This can be a particular problem for the analysis of GWAS SNP data because the number of SNPs is typically much larger than the experimental sample size. The effects of selected SNPs tend to be overestimated (sometimes called the winner's curse) and, if the threshold for inclusion is less stringent, false positives could be included in the model. In both cases, the estimated residual variance will be too low. This can, in theory, be a runaway process, because the more SNPs that are selected in the model, the lower the apparent residual variance and the greater the number of remaining SNPs that will become significant and will be added to the model. In the general population, the expected value of the LD correlation between SNPs on different chromosomes or more than d Mb distant is zero, even though, in a particular sample, the observed value is nonzero due to finite sample size. In our method, we set the LD correlation between distant SNPs to zero, because it is inappropriate to represent a randomly sampled correlation in the discovery sample by another randomly sampled correlation in the reference sample. In the conditional analysis, if a SNP to be tested is more than d Mb distant from all the top SNPs fitted in the model, we are therefore unable to model and adjust for the variability in the estimate of the SNP effect due to the sampling variation of correlations in the discovery sample. Thus, the conditional effect will be the same as the marginal effect, whereas the standard error of this SNP effect decreases as the residual variance is reduced because of the selected SNPs in the model. This signifies that test statistics will be inflated and the false positive rate will increase. This problem will be dramatically exacerbated if the discovery set is not very large, for example, coming from a single GWAS cohort, with there being a higher chance of observing a substantial correlation due to random sampling and, further, if the selected SNPs fitted in the model explain a large proportion of variance. In our method implementation, we keep the residual variance constant at the same level of the phenotypic variance, even after fitting SNPs that cumulatively explain a substantial proportion of phenotypic variation in the model (Online Methods). Although this approach is conservative, because we know that fitting the 180 known height-associated SNPs in the model reduces the residual variance by ~10% and therefore increases power to detect additional variants, it has the benefit of keeping the type-I error rate at the same level as that in the meta-analysis and thus avoids over-fitting.

To demonstrate the conservative nature of our model selection strategy, we performed selection of SNPs with a less stringent P value threshold. We constrained the analysis to region 1 Mb up- or downstream of the 180 known height-associated SNPs and chose a P value threshold of 5 × 10 –7 , as only ~13% of the genome is covered by these 2-Mb regions. We identified 85 additional associated SNPs at 60 loci, which explained 2.4% of variance in the discovery set. We validated the joint effects of these 85 SNPs by our prediction analyses. The prediction R 2 were 2.4% ( P = 8.6 × 10 –37 ) and 1.9% ( P = 5.3 × 10 –18 ) in the ARIC and QIMR cohorts, respectively, suggesting that we could detect more associated variants with a less stringent threshold but, of course, might increase the risk of including false positives. Nevertheless, this analysis confirms more heritability can be explained at a substantial proportion of loci that affect the trait. It also suggests a model of genetic architecture of a large number of loci and multiple causal variants at many of these regions.

In the GIANT meta-analysis for height and BMI 3 , 4 , the summary statistics were adjusted by the genomic control method 20 in each of the participating studies, and the test statistics were adjusted by the genomic control method for a second time in the combined analysis of all studies, which is sometimes called ‘double-GC’ correction. In the present study, we did not perform the second genomic control correction (although we have provided an option to implement this in our software tool) for two reasons. First, the purpose of genomic control correction is to adjust for the effect of population stratification, but, in the absence of population stratification and presence of polygenic inheritance, genomic inflation is expected 21 ; therefore, double-GC correction might be too conservative and overkill. Second, if the genomic inflation is due to stratification, there is no reason to find additional associated SNPs at known loci, whereas under the hypothesis that the genomic inflation is consistent with polygenic inheritance and that there are multiple variants at the same loci segregating in the population, we would expect to see what we found empirically. The GIANT conditional meta-analysis detected 16 loci with additional associated SNPs, and we identified 20 more such loci, which is partly because the GIANT conditional meta-analysis used only a subset of the discovery sample (106,336 out of 133,653 individuals) due to the difficulty of managing the large number of participating studies in a fixed time period and partly because the GIANT conditional meta-analysis implemented a double-GC correction that substantially reduced the power of detection.

The results for height and BMI seem to be very different. For height, we identified 36 loci with multiple associated SNPs, whereas, for BMI, we did not find any such loci. It seems unlikely that this large difference can be entirely explained by the greater power to detect associations with height compared to BMI because of the greater heritability of height. The narrow-sense heritability for height is estimated to be ~80% by pedigree analyses 22 , and the heritability for BMI is ~40–60% (refs. 23 , 24 ). If we assume the heritability of BMI is 50%, then 4% (2%/50%) of narrow-sense heritability for BMI has been explained by GWAS 4 , a much lower proportion than that for height, which is approximately 12.5% (10%/80%) 3 . When considering all the SNPs simultaneously, 32% (16%/50%) of narrow-sense heritability for BMI can be captured by all common SNPs using the whole-genome estimation approach we recently developed, which is also lower than the corresponding explained heritability for height (~56%) 14 , 18 . In a previous analysis partitioning genetic variance onto individual chromosomes, the variance explained by each chromosome showed a strong linear relationship with chromosome length for height, but such a relationship was rather weak for BMI 18 . To investigate whether additional variants for BMI could be detected, we performed a conditional and joint analysis with a less stringent P value threshold of 5 × 10 –6 , with the LD structure estimated from the ARIC cohort. We identified 19 multiple associated SNPs (9 leading and 10 additional SNPs) at 9 loci ( Supplementary Tables 1 and 5 ), which is still much lower than the number of additional variants detected for height. The ten additional SNPs explained 0.21% of the variance in the discovery set. When using these SNPs to predict the BMI phenotypes in the QIMR cohort, the prediction R 2 was 0.13%, which is nominally significant ( P = 0.037). Taken together, the previous and current results are consistent and suggest that the genetic architectures for height and BMI might be different in terms of the allelic spectrum of causal variants within and between loci, the distribution of effect sizes and the robustness of effect sizes to environments and gene modifiers.

We identified 36 loci with multiple associations for height. We have shown by examples of pairs of multiple associated SNPs that marginal SNP effects will be underestimated (overestimated) if their trait increasing alleles are negatively (positively) correlated, consistent with the findings from a GWAS of gene expressions 25 . However, this is not necessarily always the case when there are more than two associated SNPs in LD with each other, and the generality of these results depends on the actual LD correlations of all segregating causal variants at a locus. If one of the associated SNPs at each locus is causative, then there must be multiple causal variants in that region, because the joint effects have already taken the LD into account, such that, conditional on the causal variant in the model, the effects of any of its proxies would not be statistically significant. However, it is unlikely that the SNPs themselves are causative, because the ~2.5 million SNPs in the HapMap 2 panel of Utah residents of Northern and Western European ancestry (CEU) 26 represent only a fraction of all the polymorphisms segregating in the human population 27 . Assuming that multiple associated SNPs at a particular locus are not causative, it is unlikely that they are in LD with a single rare causal variant, especially for SNPs with minor allele frequency (MAF > 0.1), and it is also implausible that they are in LD with a single common causal variant ( Supplementary Note ). Therefore, it seems likely that there are multiple causal variants segregating at the same locus; however, this inference is indirect and inconclusive. With whole-genome sequence data, the conditional and joint analysis approach we present here will be helpful in identifying causal variants.

URLs. GCTA, http://gump.qimr.edu.au/gcta/massoc.html .

## ONLINE METHODS
The GIANT Consortium performed a meta-analysis of GWAS data in a discovery set with 133,653 and 123,865 individuals of recent European ancestry from 46 studies for height 3 and BMI 4 , respectively. In each of the participating studies, genotype data were imputed to ~2.8 million SNPs present in the HapMap Phase 2 European-American reference panel 26 , and the standard errors of all SNPs were adjusted by the genomic control method 20 . We calculated the effective sample size for each SNP and excluded SNPs with effective sample sizes of >2 s.d. from the mean. We also excluded SNPs with MAF of <0.01, retaining ~2.5 million SNPs for both height and BMI.

We also obtained access to the individual-level genotype and phenotype data of the ARIC cohort, a population-based study of Americans 28 , and the QIMR cohort, a twin study of Australians 29 . The ARIC samples were genotyped by Affymetrix 6.0 SNP array, and the QIMR samples were genotyped by Illumina 610K or 370K array. After quality control filtering of SNPs, 593,521 and 274,604 genotyped SNPs were retained in the ARIC (excluding SNPs with missingness of >2%, MAF of <0.01 or Hardy-Weinberg equilibrium (HWE) P value of <1 × 10 –3 ) and QIMR cohorts (excluding SNPs with missingness of >5%, MAF of <0.01 and HWE P value of <1 × 10 –6 ), respectively. After sample quality control analysis, 8,682 and 11,742 individuals of European ancestry in the ARIC and QIMR cohorts, respectively, were included for further analysis. The quality control protocol has been detailed previously for the ARIC cohort 18 , 30 and for the QIMR cohort 14 , 29 . We then estimated pairwise genetic relationships between individuals 14 and removed one of each pair of individuals with an estimated relatedness of >0.025. After these quality control steps, 6,654 and 3,924 unrelated individuals were retained in the ARIC and QIMR cohorts, respectively. All the ARIC samples were from adults and the QIMR samples were from 3,247 adults and 677 16-year-old adolescents. The SNP data for both ARIC and QIMR cohorts were imputed to the HapMap Phase 2 CEU panel by MACH 31 . We used the best guess genotypes of the imputed SNPs and excluded imputed SNPs with HWE P value of <1 × 10 –6 , imputation R 2 of <0.3 or MAF of <0.01 and retained 2,406,652 and 2,410,957 SNPs in the ARIC and QIMR cohorts, respectively. The ARIC cohort is part of the discovery sample of the GIANT meta-analysis, whereas the QIMR cohort is not. In the prediction analyses, the height and BMI phenotypes in the ARIC and QIMR cohorts were adjusted for age and sex effects and standardized to z scores 14 , 18 . In the QIMR cohort, only samples from 3,247 adults were used in the prediction analysis for BMI.

Under the assumption that a quantitative trait is affected by multiple genetic variants, we can express phenotypes in a sample of unrelated individuals by a multi-SNP model as (1) y = Xb + e where y = { y i } is an n × 1 vector of phenotypes, with n being the sample size, X = { x ij } is an n × N genotype matrix, with x ij = –2 p j , 1 – 2 p j or 2 – 2 p j for the j th SNP of the i th individual, with p j being the allele frequency of a SNP j and N being the number of SNPs fitted in the model, and b = { b j }, an N × 1 vector of joint SNP effects. For simplicity, we subtract the mean of the phenotype from y i , such that we do not need to fit the intercept in the model. We therefore can estimate the joint effects of multiple SNPs by the least-squares approach as (2) b ^ = ( X ′ X ) − 1 X ′ y and var ( b ^ ) = σ J 2 ( X ′ X ) − 1 where σ J 2 is the residual variance in the joint analysis.

In a GWAS or meta-analysis, however, each SNP is usually tested for association separately based on a single-SNP model (3) y = x j β j + e where x j is the j th column of X and β j is the marginal effect of SNP j . The marginal effects of multiple SNPs estimated from a single SNP–based genome scan can be written in matrix form as (4) β ^ = D − 1 X ′ y and var ( β ^ ) = σ M 2 D − 1 where β = { β j } is an N × 1 vector of marginal SNP effects, D = { D j } is the diagonal matrix of X′X with D j = ∑ i n x i j 2 and σ M 2 is the residual variance in the single-SNP analyses. The marginal SNP effects do not take the LD correlations between SNPs into account compared with the joint SNP effects. There are two issues involved in such single-SNP analyses for SNPs a short distance from each other: (i) if the increasing (or risk) alleles of two SNPs is negatively correlated, the effects of both SNPs will be attenuated; therefore, the single-SNP analysis is underpowered, and one SNP or both SNPs may be undetected and (ii) if both SNPs reach genome-wide significance, it is difficult to determine their degree of dependency by interrogating the LD afterwards.

With the summary statistics from single-SNP analyses and individual-level genotype data of the discovery sample, we can convert the marginal effects to joint effects without using the phenotype data. We know from equation (4) that X ′ y = D β ^ , and we therefore can rewrite equation (2) with respect to β ^ (5) b ^ = ( X ′ X ) − 1 D β ^ and var ( b ^ ) = σ J 2 ( X ′ X ) − 1 The proportion of phenotypic variance explained by all the SNPs (coefficient of determination of a multiple regression model) is (6) R J 2 = b ^ ′ X ′ y y ′ y = b ^ ′ D β ^ y ′ y giving the following equation: (7) σ ^ J 2 = ( 1 − R J 2 ) y ′ y n − N = y ′ y − b ^ ′ D β ^ n − N In an association analysis of a single SNP j , (8) σ ^ M ( j ) 2 = y ′ y − D j β ^ j 2 n − 1 and the squared standard error of the estimate of the effect size is S j 2 = σ ^ M ( j ) 2 ∕ D j so that y ′ y = D j S j 2 ( n − 1 ) + D j β ^ j 2 . Although the phenotypes of a quantitative trait are often standardized to z scores, we take the median of D j S j 2 ( n − 1 ) + D j β ^ j 2 across all the SNPs to calculate y′y instead of relying on the variance being known.

For a meta-analysis of a large number of cohorts, such as the GIANT Consortium meta-analysis 3 , 4 , we are usually unable to obtain pooled individual-level genotype data of the whole discovery set; hence, we do not have the X′X matrix. X′X is essentially a variance-covariance matrix of SNP genotypes, which can be estimated from the allele frequencies in the meta-analysis sample along with LD correlations between SNPs from a reference sample, such as one of the meta-analysis cohorts for which individual-level genotype data are available. We let W = { w ij } denote the genotype matrix of the reference sample with sample size of m , where w ij = –2 f j , 1 – 2 f j or 2 – 2 f j for the three genotypes, with f j being the allele frequency of a SNP j in the reference sample, and we let D W denote the diagonal matrix of W′W with D W ( j ) = ∑ i m w i j 2 . If the reference sample is from the same population as the meta-analysis sample, the LD correlation between a pair of SNPs j and k should be similar in the two samples 32 , 33 , with (9) ∑ i n x i j x i k ∑ i n x i j 2 ∑ i n x i k 2 ≈ ∑ i m w i j w i k ∑ i m w i j 2 ∑ i m w i k 2 so that X′X is approximately equal to B , with the jk th element of B being (10) B j k ≈ D j D k D W ( j ) D W ( k ) ∑ i m w i j w i k

We have defined above that D j = ∑ i n x i j 2 and, as x ij is not available in this case, we thus take D j = 2 p j (1 – p j ) n , assuming HWE and can show this in matrix form: (11) B = D 1 ∕ 2 D W − 1 ∕ 2 W ′ WD W − 1 ∕ 2 D 1 ∕ 2 Therefore, we can approximate a joint analysis of multiple SNPs as (12) b ~ = B − 1 D β ^ and var ( b ~ ) = σ J 2 B − 1 where b̃ = { b̃ j } is an N × 1 vector of approximate estimates of joint SNP effects. If a SNP is uncorrelated with all other SNPs in the model, then the estimate of the effect size from the joint analysis will be identical to that from the meta-analysis. In a genetically homogenous population of large effective size, the expected value of LD correlation between two SNPs on different chromosomes or a large distance apart is approximately zero, and the observed LD correlations between such pairs of SNPs in a sample are just a result of random sampling. We show with empirical data that the observed LD correlation between SNPs more than 10 Mb apart is consistent with what we would expect by chance ( Supplementary Fig. 7 ). We use the expected values (zeros) in the matrix B for such pairs of distant SNPs, because it is more appropriate to represent a sampled correlation observed in the meta-analysis sample by its expected value rather than another sampled correlation observed in the reference sample unless the whole meta-analysis sample is used as the reference sample.

In addition, the sample size varies for different SNPs due to imputation failures for different SNPs in different participating studies. Therefore, n is no longer constant across different SNPs, and we need to rescale the elements of B and D according to the different effective sample sizes of different SNPs. For any SNP j , (13) n ^ j = y ′ y ∕ D j S j 2 − β ^ j 2 ∕ S j 2 + 1 where we take the variance explained by a single SNP into account, considering that the effect sizes of some particular SNPs are large for some traits. We use the estimated effective sample size rather than the reported sample size, because the effective sample size will be smaller than the reported sample size if there is some degree of relatedness in the data. We then adjust the jk th element of B for the sample size variability of the SNPs as (14) B j k = min ( n ^ j , n ^ k ) 2 p j ( 1 − p j ) p k ( 1 − p k ) ∑ i m w i j 2 ∑ i m w i k 2 ∑ i m w i j w i k and adjust the j th diagonal element of D as D j = 2 p j (1 – p j ) n̂ j .

In a linear regression analysis of multiple SNPs, the least-squares estimates of the joint effects of one set of SNPs conditional on another set of SNPs ( b 2 | b 1 ) are (15) b ^ 2 ∣ b ^ 1 = ( X 2 ′ X 2 ) − 1 X 2 ′ y − ( X 2 ′ X 2 ) − 1 X 2 ′ X 1 ( X 1 ′ X 1 ) − 1 X 1 ′ y (16) var ( b ^ 2 ∣ b ^ 1 ) = σ C 2 ( X 2 ′ X 2 ) − 1 − σ C 2 ( X 2 ′ X 2 ) − 1 X 2 ′ X 1 ( X 1 ′ X 1 ) − 1 X 1 ′ X 2 ( X 2 ′ X 2 ) − 1 where σ C 2 is the residual variance in the conditional analysis and all the other variables and parameters are defined as above, with the subscripts 1 and 2 indicating the two SNP sets. We can perform a multi-SNP conditional analysis using summary data from single-SNP analyses and individual-level genotype data of the sample without accessing the phenotype data by (17) b ^ 2 ∣ b ^ 1 = ( X 2 ′ X 2 ) − 1 D 2 β ^ 2 − ( X 2 ′ X 2 ) − 1 X 2 ′ X 1 ( X 1 ′ X 1 ) − 1 D 1 β ^ 1 (18) σ ^ C 2 = y ′ y − b ^ 1 ′ D 1 β ^ 1 − ( b ^ 2 ∣ b ^ 1 ) ′ D 2 β ^ 2 ( n − N 1 − N 2 ) where N 1 and N 2 are the number of SNPs in the two sets. If there is only one SNP to be tested in the conditional analysis ( N 2 = 1), then equations (17) and (18) simplify to (19) b ^ 2 ∣ b ^ 1 = β ^ 2 − ( X 2 ′ X 2 ) − 1 X 2 ′ X 1 ( X 1 ′ X 1 ) − 1 D 1 β ^ 1 (20) var ( b ^ 2 ∣ b ^ 1 ) = σ ^ C 2 [ D 2 − X 2 ′ X 1 ( X 1 ′ X 1 ) − 1 X 1 ′ X 2 ] ∕ D 2 2 where b̂ 2 , β ^ 2 and D 2 are scalars.

As in a joint analysis, if the individual-level genotype data of the discovery sample are unavailable, we can estimate the LD correlations from the reference sample and approximate a conditional analysis as (21) b ~ 2 ∣ b ~ 1 = B 2 − 1 D 2 β ^ 2 − B 2 − 1 CB 1 − 1 D 1 β ^ 1 (22) var ( b ~ 2 ∣ b ~ 1 ) = σ C 2 B 2 − 1 − σ C 2 B 2 − 1 CB 1 − 1 C ′ B 2 − 1 where B 1 and B 2 are similar as in equation (11) and C ≈ X 2 ′ X 1 with the jk th element. (23) C j k = min ( n ^ 2 j , n ^ 1 k ) 2 p 2 j ( 1 − p 2 j ) p 1 k ( 1 − p 1 k ) ∑ i m w 2 i j 2 ∑ i m w 1 i k 2 ∑ i m w 2 i j w 1 i k

There are many ways of performing model selection in a multiple regression framework. We use the following stepwise selection strategy to select the associated SNPs iteratively over all the SNPs across the whole genome, regardless of their P values from the meta-analysis, except for the most significant SNP, which was used for model initiation. Start with a model with the most significant SNP in the single-SNP meta-analysis across the whole genome with P value below a cutoff P value, such as 5 × 10 –8 . For the t th step, calculate the P values of all the remaining SNPs conditional on the SNP(s) that have already been selected in the model. To avoid problems due to colinearity, if the squared multiple correlation between a SNP to be tested and the selected SNP(s) is larger than a cutoff value, such as 0.9, the conditional P value for that SNP will be set to 1. Select the SNP with minimum conditional P value that is lower than the cutoff P value. However, if adding the new SNP causes new colinearity problems between any of the selected SNPs and the others, we drop the new SNP and repeat this process. Fit all the selected SNPs jointly in a model and drop the SNP with the largest P value that is greater than the cutoff P value. Repeat processes (2), (3) and (4) until no SNPs can be added or removed from the model. A multiple regression analysis with model selection, such as that presented above, might suffer from over-fitting of effects, because the residual variance decreases as more and more SNPs are included in the model, such that the false positive rate for the inclusion of new SNPs in the model would be inflated. In practice, we keep the residual variance constant to the phenotypic variance, even if we added significant SNPs into the model, which may be too conservative and may therefore result in a loss of power to detect additional associated variants but has the benefit of keeping the false positive rate in the conditional and joint analysis at the same level as in the meta-analysis. If a SNP has no correlation with any of the SNPs selected in the model, its P value in the conditional or joint analysis will remain the same as it is in the meta-analysis.

Start with a model with the most significant SNP in the single-SNP meta-analysis across the whole genome with P value below a cutoff P value, such as 5 × 10 –8 .

For the t th step, calculate the P values of all the remaining SNPs conditional on the SNP(s) that have already been selected in the model. To avoid problems due to colinearity, if the squared multiple correlation between a SNP to be tested and the selected SNP(s) is larger than a cutoff value, such as 0.9, the conditional P value for that SNP will be set to 1.

Select the SNP with minimum conditional P value that is lower than the cutoff P value. However, if adding the new SNP causes new colinearity problems between any of the selected SNPs and the others, we drop the new SNP and repeat this process.

Fit all the selected SNPs jointly in a model and drop the SNP with the largest P value that is greater than the cutoff P value.

Repeat processes (2), (3) and (4) until no SNPs can be added or removed from the model.

We know from the methods above that the scale of measurement of a quantitative trait is not important, as it can be dropped from the equations. We therefore extend these methods to be applied to the case-control study design, assuming that the disease liabilities ( L ) of all the individuals are known, and model the effects of multiple SNPs. (24) L = Xb + e

There are two distributions that are often assigned to the residuals to transform the underlying liability to the probability of being affected or unaffected, the standard normal distribution (probit model) and the logistic distribution (logistic regression). Given the logistic probability function of f ( l i ) = exp( l i )/[1 + exp( l i )] with l i being the liability of the i th individual, the odds ratio (OR) for a SNP j in a multiple-SNP analysis is exp( b j ), with b j being the log(OR) in a joint analysis, and is exp(β j ) for a single-SNP model L = x j β j + e , with β j being the log(OR) in a single-SNP analysis. Even though the residuals follow a logistic distribution, the least-squares estimates of effect sizes are unbiased, because the least-squares approach does not rely on the assumption of normality. Hence, we can apply the same methods as described above for a quantitative trait to a case-control study, as long as the effect sizes and standard errors are expressed on the log(OR) scale.

The method described above has been implemented as an option in the GCTA software package (see URLs) 19 .