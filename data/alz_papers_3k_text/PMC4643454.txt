# Title
Gene-gene and gene-environment interactions detected by transcriptome sequence analysis in twins

## Online Methods
The study included 856 Caucasian female individuals recruited from the TwinsUK Adult twin registry. Punch biopsies (8mm) were taken from a photo-protected area adjacent and inferior to the umbilicus. Subcutaneous adipose tissue was dissected from each biopsy, weighed and immediately stored in liquid nitrogen. Similarly, the remaining skin tissue was weighed and stored in liquid nitrogen. Peripheral blood samples were collected and lymphoblastoid cell lines (LCLs) were generated by Epstein Barr Virus transformation of the B-lymphocyte component by the European Collection of Cell Cultures agency.

The St. Thomas' Research Ethics Committee (REC) approved on 20th September 2007 the protocol for dissemination of data, including DNA, with the REC reference number RE04/015. On 12th of March of 2008, the St Thomas' REC confirmed this approval extends to expression data. Volunteers gave informed consent and signed an approved consent form prior to the biopsy procedure. Volunteers were supplied with an appropriate detailed information sheet regarding the research project and biopsy procedure by post prior to attending for the biopsy.

Samples were genotyped on a combination of the HumanHap300, HumanHap610Q, 1M-Duo and 1.2MDuo 1M Illumnia arrays. Samples were imputed into the 1000 Genomes Phase 1 reference panel (data freeze, 10/11/2010) 15 using IMPUTE2 16 and filtered (MAF<0.01, IMPUTE info value < 0.8).

Samples were prepared for sequencing with the Illumina TruSeq sample preparation kit (Illumina, San Diego, CA) according to manufacturer’s instructions and were sequenced on a HiSeq2000 machine. Afterwards, the 49-bp sequenced paired-end reads were mapped to the GRCh37 reference genome 17 with BWA v0.5.9 18 . We use genes defined as protein coding in the GENCODE 10 annotation 19 . We excluded samples that failed in the library prep or sequence process. We also excluded samples with less than 10 million reads sequenced and mapped to the exons. Finally we excluded samples in which the sequence data did not correspond with the actual genotype data. We ended with 766 samples for fat, 814 for LCL, 716 for skin and 384 for blood (we had blood samples for only half of the individuals).

All overlapping exons of a gene were merged into meta-exons with identifier of the form “geneID_start.pos_end.pos”. We counted a read in a meta-exon if either its start or end coordinate overlapped a meta-exon.

All read count quantifications were corrected for variation in sequencing depth between samples by normalizing the reads to the median number of well-mapped reads. We used only exons quantified in more than 90% of the individuals. We removed the effects of technical covariates regressing out the first 50 factors from PEER 20 , including BMI and age in the model to preserve important biological sources of variation.

Since our data samples are twins, they are not independent observations and we needed to take that into account in our models. We used the two-steps strategy described in Aulchenko et al. 21 First we kept the residuals of a mixed model that removed the effects of the family structure using the implementation in GenAbel R package. We then transformed those residuals using a rank normal transformation. Finally, we performed a linear regression of the transformed residuals on the SNPs in a 1Mb window around the transcription start site for each gene, using MatrixeQTL R package 22 . We did the association at the exon level and we kept the best association per gene.

We permuted the quantifications of each exon 2000 times, keeping the best p-value per exon from each round. From these data, we adjusted the empirical FDR to 1% according to the most stringent exon of each gene, stratifying the analysis on the number of exons for a given gene.

In all the ASE analyses we excluded sites that are susceptible to allelic mapping bias: 1) sites with 50bp mapability < 1 based on the UCSC mapability track, implying that the 50bp flanking region of the site is non-unique in the genome, and 2) simulated RNA-seq reads overlapping the site that show >5% difference in the mapping of reads that carry the reference or non-reference allele. To verify that the genotype is a true heterozygous, we used only sites with >=30 reads, and sites where both alleles are observed in RNAseq data 7 .

We assessed statistically significant ASE sites using a binomial test. We did a test for each heterozygous SNP in every individual to detect the presence of statistically significant allelic imbalance. For each site-individual we counted the number of reads covering each allele and calculated a binomial test comparing the observed proportion of reference allele counts with the expected proportion. In theory, this expected proportion should be 0.5 but mapping bias can change it a little bit. To correct for systematic bias in allelic ratios we calculated the overall reference to total allele ratio for each individual for each SNP base combination. These ratios were then used as the expected ratios in the binomial test. We called significant ASE sites using a 10% FDR threshold. We assess the robustness of our significant ASE calls in four ways. First, we evaluated the concordance of ASE among tissues by measuring ASE of ASE significant sites from one tissue in another tissue in the same individual and observed a replication rate about 70% in the three tissues with complete sample size ( Supplementary Fig. 5 ). We then analyzed 5 samples of the GEUVADIS project that where sequenced between 2 and 7 times in different laboratories 7 , 23 . We observed that the ASE ratio is quite stable for coverage of 30 reads or more ( Supplementary Fig. 6 ). We also observed that the agreement in ASE significant calls is stable for different coverages ( Supplementary Fig. 7 ). Finally, we analyzed two LCL samples (from the Geuvadis Project 7 ) following the same protocol and analysis pipeline as the one described in the present paper and compared the results to the ASE ratios obtained from a new technique that uses microfluidic multiplex PCR and sequencing (mmPCR) 24 . The experimental and statistical analysis of the two samples was independently performed in the two different laboratories. We found a very good agreement between the results we obtained using RNAseq and the new mmPCR technique. The replication rate is about 80-82% and the correlation among the ASE ratios for sites that are significant using RNAseq is 0.86 ( Supplementary Fig. 8 ). These observations show a high degree of replicability of ASE measures.

The measure we used for the variance components analysis of ASE is the logit of the percentage of reference alleles. Being p = REF _ COUNT / TOTAL _ COUNT the percentage of reference allele at a site for an individual, the measure of ASE is: ASE = log ( p 1 − p ) = log ( REF _ COUNT NONREF _ COUNT )

This measure is not dependent on the overall gene expression level and thus is not susceptible to give false interactions due to trans effects or environmental effects that increase the overall level of expression ( Supplementary Fig. 9 and Supplementary Fig. 10 ).

We calculated the haplotypes in a 1Mb window around the TSS of each gene and counted the number of haplotype alleles that are shared between the twin pairs at each locus.

We estimated IBS for each twin pair at each locus based on the eQTL-ASE site haplotype. For each site, we counted the number of alleles in the eQTL-ASE site haplotype that are equal between the pair.

The difference between the IBS an the IBD estimates is that for the IBD we take into account the information of a 1Mb haplotype and for the IBS estimates we use only the haplotype with two SNPs: the eQTL and the ASE site.

Classical variance components models in twins model the phenotypic correlation between MZ twins and DZ twins as a function of the additive genetic variance and the shared environment variance 25 : cor mz = A + C and cor dz = 1 2 A + C where A represents the additive genetic effects and C the effects due to the common environment between the twin pair (events that affect each member of a twin pair in the same way). The individual environmental effect (events that occur to one twin but not the other) would be E = 1 – cor mz . From the two equations above, we get that heritability can be estimated as: h 2 = A = 2 ( cor mz − cor dz )

Here, we extend this model to incorporate new sources of variation: - A qtl : additive effect due to the best eQTL - A cis : other genetic additive effects in cis - A trans : additive genetic effects in trans - I : epistatic interaction between trans and cisgenetic effects Where A = A qtl + A cis + A trans + I

A qtl : additive effect due to the best eQTL

A cis : other genetic additive effects in cis

A trans : additive genetic effects in trans

I : epistatic interaction between trans and cisgenetic effects

Then, our model has six variance component: 1) variance due to the effect of the major cis eQTL (the IBS status at this locus), 2) variance due to the rest of the genetic variants in cis (including the effect of rare variants, captured by the IBD status), 3) variance due to genetic variants in trans (the genome-wide IBD), 4) variance due to non-additive genetic effects (genetic interactions), 5) variance due to the shared environmental effect and 6) variance due to the individual environmental effect.

The equations of the extended model are: cor mz = A qtl + A cis + A trans + I + C cor dz _ ibd 1 = A qtl + A cis + 1 2 A trans + 1 2 I + C cor dz _ ibd 05 _ ibs 1 = A qtl + 1 2 A cis + 1 2 A trans + 1 4 I + C cor dz _ ibd 05 _ ibs 05 = 1 2 A qtl + 1 2 A cis + 1 2 A trans + 1 4 I + C cor dz _ ibd 0 _ ibs 1 = A qtl + 1 2 A trans + C cor dz _ ibd 0 _ ibs 05 = 1 2 A qtl + 1 2 A trans + C cor dz _ ib d 0 _ ibs 0 = 1 2 A trans + C Where: cor mz is the correlation within MZ twins cor dz_ibd1 is the correlation within DZ twins that are IBD=1 at the gene cor dz_ibd 05_ ibs 1 is the correlation within DZ twins that are IBD=0.5 at the gene and IBS=1 at the eQTL cor dz_ibd 05_ ibs 05 is the correlation within DZ twins that are IBD=0.5 at the gene and IBS=0.5 at the eQTL cor dz_ibd 0_ ibs 1 is the correlation within DZ twins that are IBD=0 at the gene and IBS=1 at the eQTL cor dz_ibd 0_ ibs 05 is the correlation within DZ twins that are IBD=0 at the gene and IBS=0.5 at the eQTL cor dz_ibd 0_ ibs 0 is the correlation within DZ twins that are IBD=0 at the gene and IBS=0 at the eQTL

To calculate these correlations we used sites covered by at least 30 reads, showing significant ASE in genes with at least one cis eQTL. Since the number of individuals that have ASE at a given site is small, we analyzed all the sites together to get a global estimate of the variance components. This strategy has been used previously with gene expression data 1 , 26 .

To solve the system of equations we used the non-linear optimization package Rsolnp from the R statistical environment 27 . We estimated the solution that minimizes the quadratic errors, forcing the variances components to be positive.

For every ASE site with data for at least 50 MZ twin pairs we calculated the Mann-Whitney test: ASE _ distance ~ snp i for all the SNPs in a 1Mb window around the transcription start site of the gene holding the ASE site. ASE_distance is the absolute value of the difference in the ASE phenotype between the two siblings of the MZ pair and snp i represents the genotype of one SNP. Since we are looking for an effect on ASE we expect a similar behavior for the two homozygous genotypes. Therefore, for the association analysis we coded the genotypes in two categories: homozygous and heterozygous. To correct for multiple testing we calculated the number of effective tests and applied the Bonferroni correction based on these number of tests. Since MZ twins are genetically identical, a difference in ASE between two MZ siblings has to be caused by environmental/epigenetic causes. A significant association in our tests suggests the existence a G×E interaction affecting ASE. It is worth noting that the associated SNP genotype is not equivalent to the existence of ASE as other variants may be contributing to ASE as well. There are cases of homozygous pairs with ASE and heterozygous pairs without ASE and that, in all cases, the difference in ASE is larger for the heterozygous ( Supplementary Fig. 11 ). Finally, the existence of ASE does not imply a significant G×E interaction as shown in Supplementary Fig. 12 .