# Title
A Single Cell Transcriptomic Atlas Characterizes Aging Tissues in the Mouse

# Abstract
Aging is characterized by a progressive loss of physiological integrity, leading to impaired function and increased vulnerability to death 1 . Despite rapid advances over recent years, many of the molecular and cellular processes which underlie progressive loss of healthy physiology are poorly understood 2 . To gain a better insight into these processes we have created a single cell transcriptomic atlas across the life span of Mus musculus which includes data from 23 tissues and organs. We discovered cell-specific changes occurring across multiple cell types and organs, as well as age related changes in the cellular composition of different organs. Using single-cell transcriptomic data we were able to assess cell type specific manifestations of different hallmarks of aging, such as senescence 3 , genomic instability 4 and changes in the organism’s immune system 2 . This Tabula Muris Senis provides a wealth of new molecular information about how the most significant hallmarks of aging are reflected in a broad range of tissues and cell types.

## Methods
All data, protocols, analysis scripts and an interactive data browser are publicly available.

## Experimental Procedures
Male and virgin female C57BL/6JN mice were shipped from the National Institute on Aging colony at Charles River (housed at 67–73 °F) to the Veterinary Medical Unit (VMU; housed at 68–76 °F)) at the VA Palo Alto (VA). At both locations, mice were housed on a 12-h light/dark cycle and provided food and water ad libitum . The diet at Charles River was NIH-31, and Teklad 2918 at the VA VMU. Littermates were not recorded or tracked, and mice were housed at the VA VMU for no longer than 2 weeks before euthanasia, with the exception of mice older than 18 months, which were housed at the VA VMU beginning at 18 months of age. Before tissue collection, mice were placed in sterile collection chambers at 8 am for 15 min to collect fresh fecal pellets. After anaesthetization with 2.5% v/v Avertin, mice were weighed, shaved, and blood was drawn via cardiac puncture before transcardial perfusion with 20 ml PBS. Mesenteric adipose tissue was then immediately collected to avoid exposure to the liver and pancreas perfusate, which negatively affects cell sorting. Isolating viable single cells from both the pancreas and the liver of the same mouse was not possible; therefore, two males and two females were used for each. Whole organs were then dissected in the following order: large intestine, spleen, thymus, trachea, tongue, brain, heart, lung, kidney, gonadal adipose tissue, bladder, diaphragm, limb muscle (tibialis anterior), skin (dorsal), subcutaneous adipose tissue (inguinal pad), mammary glands (fat pads 2, 3 and 4), brown adipose tissue (interscapular pad), aorta and bone marrow (spine and limb bones). Organ collection concluded by 10 am. After single-cell dissociation as described below, cell suspensions were either used for FACS of individual cells into 384-well plates, or for preparation of the microfluidic droplet library. All animal care and procedures were carried out in accordance with institutional guidelines approved by the VA Palo Alto Committee on Animal Research.

All tissues were processed as previously described 5 .

No sample size choice was performed before the study. Randomization and blinding were not performed: the authors were aware of all data and metadata-related variables during the entire course of the study.

All protocols used in this study are described in detail elsewhere 5 . Those include: i) preparation of lysis plates, ii) FACS sorting, iii) cDNA synthesis using the Smart-seq2 protocol 51 , 52 , iv) library preparation using an in-house version of Tn5 53 , 54 ,v) library pooling and Quality control and vi) sequencing. For further details please refer to http://dx.doi.org/10.17504/protocols.io.2uwgexe

Single cells were captured in droplet emulsions using the GemCode Single-Cell Instrument (10x Genomics) and scRNA-seq libraries were constructed as per the 10x Genomics protocol using GemCode Single-Cell 3′ Gel Bead and Library V2 Kit. In brief, single cell suspensions were examined using an inverted microscope, and if sample quality was deemed satisfactory, the sample was diluted in PBS with 2% FBS to a concentration of 1000 cells per μl. If cell suspensions contained cell aggregates or debris, two additional washes in PBS with 2% FBS at 300 g for 5 min at 4 °C were performed. Cell concentration was measured either with a Moxi GO II (Orflo Technologies) or a haemocytometer. Cells were loaded in each channel with a target output of 5,000 cells per sample. All reactions were performed in the Biorad C1000 Touch Thermal cycler with 96-Deep Well Reaction Module. 12 cycles were used for cDNA amplification and sample index PCR. Amplified cDNA and final libraries were evaluated on a Fragment Analyzer using a High Sensitivity NGS Analysis Kit (Advanced Analytical). The average fragment length of 10x cDNA libraries was quantitated on a Fragment Analyzer (AATI), and by qPCR with the Kapa Library Quantification kit for Illumina. Each library was diluted to 2 nM, and equal volumes of 16 libraries were pooled for each NovaSeq sequencing run. Pools were sequenced with 100 cycle run kits with 26 bases for Read 1, 8 bases for Index 1, and 90 bases for Read 2 (Illumina 20012862). A PhiX control library was spiked in at 0.2 to 1%. Libraries were sequenced on the NovaSeq 6000 Sequencing System (Illumina).

## Computational methods
Sequences from the NovaSeq were de-multiplexed using bcl2fastq version 2.19.0.316. Reads were aligned using to the mm10plus genome using STAR version 2.5.2b with parameters TK. Gene counts were produced using HTSEQ version 0.6.1p1 with default parameters, except ‘stranded’ was set to ‘false’, and ‘mode’ was set to ‘intersection-nonempty’. Sequences from the microfluidic droplet platform were de-multiplexed and aligned using CellRanger version 2.0.1, available from 10x Genomics with default parameters.

Gene count tables were combined with the metadata variables using the Scanpy 55 Python package version 1.4.2. We removed genes not expressed in at least 3 cells and then cells that did not have at least 250 detected genes. For FACS we removed cells with less than 5000 counts and for droplet cells with less than 2500 UMIs. The data was then normalized using size factor normalization such that every cell has 10,000 counts and log transformed. We computed highly variable genes using default parameters and then scaled the data to a maximum value of 10. After we computed PCA, neighborhood graph and clustered the data using Louvain 7 and Leiden 8 methods. The data was visualized using UMAP projection. When performing batch correction to remove the technical artifacts introduced by the technologies, we replaced the neighborhood graph computation with bbknn 6 . Step-by-step instructions to reproduce the pre-processing of the data are available from GitHub.

To define cell types we analyzed each organ independently but combining all ages. In a nutshell, we performed principal component analysis on the most variable genes between cells, followed by Louvain and Leiden graph-based clustering. Next we subset the data for 3m (Tabula Muris 5 ) and compute how many cell types map to each individual cluster. For the clusters that we had a single 1:1 mapping (cluster:cell type) we propagate the annotations for all ages; in case there is a 1:many mapping we flagged that cluster for manual validation. Step-by-step instructions to reproduce this method are available from GitHub. For each cluster, we provide annotations in the controlled vocabulary of the cell ontology 56 to facilitate inter-experiment comparisons. Using this method, we were able to annotate automatically (~1min per tissue) over 70% of the dataset. The automatic annotations were then reviewed by each of the tissue experts leading to a fully curated dataset for all the cell types in Tabula Muris Senis.

For each tissue and age, we computed the relative proportion of each cell type. Next we used scipy.stats linregress to regress the relative tissue-cell type changes against age and considered significant the changes with p-value<0.05 for a hypothesis test whose null hypothesis is that the slope is zero, using two-sided Wald Test with t-distribution of the test statistic and a r 2 >0.5.

We performed differential gene expression analysis on each tissue with a well-powered sample size (>100 cells in both young (1m and 3m) and old age group (18m, 21m, 24m and 30m)). We used a linear model 57 treating age as a numerical variable while controlling for sex and technology. We applied a false-discovery rate (FDR) threshold of 0.01 and an age coefficient threshold of 0.005 (corresponding to ~10% fold change).

In situ RNA hybridization was performed using the Advanced Cell Diagnostics RNAscope® Multiplex Fluorescent Detection kit v2 (323110, Bio-techne) according to the manufacturer’s instructions. Staining of mouse liver specimens was performed using 5μm paraffin-embedded thick sessions. Mouse livers were fixed in 10% formalin buffer saline (HT501128, Sigma Aldrich) for 24h at room temperature before paraffin embedding. For multiplex staining the following probes were used; Clec4f (Mm-Clec4f 480421, Il1b (Mm-Il1b 316891-C2), Pecam1 (Mm-Pecam-1 316721), Mrc1 (Mm-Mrc1 437511-C3). Slides were counter stained with Prolong gold antifade reagent with DAPI (P36931, Life technologies). Mounted slides were imaged on a Leica DM6 B fluorescent microscope (Leica Biosystems). Image quantification was performed using the starfish open source image-based transcriptomics pipeline (please refer to Starfish: Open Source Image Based Transcriptomics and Proteomics Tools available from http://github.com/spacetx/starfish and 58 )

The differential gene analysis was defined on a per tissue basis. First, we investigated genes based on the single-cell data. We only considered cells from male animals and perform our analysis on the log (1 + CPM) transformed single-cell count matrices. Note that normalization of the single-cell data was done on a per cell basis. We defined two groups of cells based on age: young cells with age <= 3 months (Y) and old cells with age > 3 months (O). For each gene we compute the log2 fold-change of cell and read counts between O and Y. We defined cell count as the fraction of cells that express the gene. Similarly, we defined read count as the mean read count of the gene in the cells that express it. The calculated log2 fold-changes of a gene reflect its expression changes with aging within the single-cell data. Next we analyze each gene based on the bulk data. We computed the Spearman (Sp) correlation of bulk DESeq2 normalized gene expression with aging. We defined two groups of genes based on the bulk data, increasing with age Sp > 0.7 (U) and decreasing with age Sp < −0.7 (D). Finally, we compared the single-cell data based log2 fold-changes between the bulk data defined groups U and D. Specifically, we run Wilcoxon–Mann–Whitney test in order to understand if log2 fold-changes of cell or read counts could distinguish between the two groups. We used the U statistic for effect size.

We used TraCeR 44 version 0.5 to identify T-Cell clonal populations. We ran tracer assemble with --species Mmus set. We then ran tracer summarise with –species Mmus to create the final results. We used the following versions for TraCeR dependencies: igblast version 1.7.0, kallisto version v0.43.1, Salmon version 0.8.2, Trinity version v2.4.0, GRCm38 reference genome. Step-by-step instructions to reproduce the processing of the data are available from GitHub.

We used singlecell-ige 43 version eafb6d126cc2d6511faae3efbd442abd7c6dc8ef ( https://github.com/dcroote/singlecell-ige ) to identify B-Cell clonal populations. We used the default configuration settings except we set the species to mouse. Step-by-step instructions to reproduce the processing of the data are available from GitHub.

We used samtools 59 version 1.9 and GATK 39 version v4.1.1.0 for mutation analysis. We used samtools faidx to create our index file. Then we used GATK CreateSequenceDictionary and GRCm38, as the reference, to create our sequence dictionary. Next we used GATK AddOrReplaceReadGroups to create a single read group using parameters -RGID 4 -RGLB lib1 -RGPL illumina -RGPU unit1 -RGSM 20. Finally we used GATK HaplotypeCaller to call the mutations. We disabled the following read filters: MappingQualityReadFilter, GoodCigarReadFilter, NotSecondaryAlignmentReadFilter, MappedReadFilter, MappingQualityAvailableReadFilter, NonZeroReferenceLengthAlignmentReadFilter, NotDuplicateReadFilter, PassesVendorQualityCheckReadFilter, and WellformedReadFilter, but kept all other default settings. The results were summarized per gene in the form of a mutation count per cell table. We started by removing genes mutated in over 60% of cells, to eliminate the possible bias of germline mutations. Then for each tissue we selected genes expressed in at least 75% of the cells for all the time points to avoid confounding the mutation results with differential gene expression associated with age. Next we computed the average number of mutations in the gene set (or ERCC spike-in controls) per cell and also the average number of raw counts ( Supplementary Table 8 ) and plotted the different distributions. Step-by-step instructions to reproduce the processing of the data are available from GitHub.

We used partition-based graph abstraction (PAGA 60 ) to reconstruct the aging trajectory in brain microglial cells. Step-by-step instructions to reproduce the processing of the data are available from GitHub.

The raw FACS or droplet dataset were used as the input. We filtered genes expressed in fewer than 5 cells, filtered cells if expressing fewer than 500 genes and discarded cells with total number of counts less than 5000. Next we performed size factor normalization such that every cell had 1e4 counts and performed a log1p transformation. This was followed by clustering, where we clustered every tissue and every tissue-cell type for every mouse separately using 6 different configurations: resolution parameters (0.3, 0.5, 0.7) * clustering method (Louvain, Leiden). This is to provide a robust clustering result. For each combination (each tissue-mouse and each tissue-cell_type-mouse), we computed the clustering diversity score as the Shannon entropy of the cluster assignment. We then regressed the diversity score against age to detect the systematic increase/decrease of clustering diversity with respect to age. FDR was used to correct for multiple comparisons. A tissue or a tissue-cell type was selected if the slope was consistent (having the same sign) in all 6 clustering configurations and at least 2 out of 6 clustering configurations had FDR<0.3. For each selected tissue or tissue-cell type, a separate UMAP was computed using cells from all mice for visualization using Leiden clustering with resolution parameter 0.7.

http://tabula-muris-senis.ds.czbiohub.org/

https://tabula-maris-senis.cells.ucsc.edu

## Extended Data
a,b , UMAP plot of all cells collected for FACS colored by tissue ( a ) or age ( b ). c , UMAP plot of all cells collected by FACS, colored by organ ( Extended Data Figure 4c ), overlaid with the Louvain cluster numbers. n = 110,824 individual cells for FACS. d,e , UMAP plot of all cells collected for droplet colored by tissue ( d ) or age ( e ). f , UMAP plot of all cells collected by droplet, colored by organ ( Extended Data Figure 4c ), overlaid with the Louvain cluster numbers. n = 245,389 individual cells for droplet. g , B cells (top) and endothelial cells (bottom) in FACS independently annotated for each organ cluster together by unbiased whole-transcriptome Louvain clustering, irrespectively of the organ they originate from. h , B cells (and endothelial cells) in droplet independently annotated for each organ cluster together by unbiased whole-transcriptome Louvain clustering, irrespectively of the organ where they were found. i,j , UMAP plot of all cells collected colored by method ( i ) or tissue ( j ). n = 356,213 individual cells for FACS and droplet combined. k,l , B cells ( k ) and endothelial cells ( l ) cluster together by unbiased whole-transcriptome Louvain clustering, irrespectively of the technology with which they were found.

a, Pie chart with the summary statistics for FACS. b, Pie chart with the summary statistics for droplet. c , Box plot of the number of genes detected per cell for each organ and age for FACS d , Box plot of the number of reads per cell (log-scale) for each organ and age for FACS. For c and d , all data are expressed as mean ± s.d. The sample size (number of cells for each tissue and age) is available in Supplementary Table 1 .

a , Box plot of the number of genes detected per cell for each organ and age for droplet. b , Box plot of the number of UMIs per cell (log-scale) for each organ and age for droplet. All data are expressed as mean ± s.d. The sample size (number of cells for each tissue and age) is available in Supplementary Table 2 .

a , Balloon plot showing the number of sequenced cells per sequencing method per organ per sex per age. b , Schematic analysis workflow. c,d, Tabula Muris Senis color dictionary for organs and tissues ( c ) and ages ( d ).

a,b, Aging patterns from bulk and single-cell data are consistent. Strong changes in bulk gene expression with aging can be either explained by cell or read count-based changes in single-cell data FACS ( a ) and droplet ( b ). Two-sided Wilcoxon–Mann–Whitney indicates that single-cell data based log2 fold-changes of cell or read counts distinguish between up and down regulated genes in bulk data. n = 110,824 individual cells for FACS and n = 245,389 individual cells for droplet. c , Mammary gland T cell relative abundances change significantly with age (p-value<0.05 and r 2 >0.7 for a hypothesis test whose null hypothesis is that the slope is zero, using two-sided Wald Test with t-distribution of the test statistic). d , Top 20 upregulated and downregulated genes in mammary gland computed using MAST 57 , treating age as a continuous covariate while controlling for sex and technology. Genes were classified as significant under an FDR threshold of 0.01 and an age coefficient threshold of 0.005 (corresponding to ~10% fold change). n=6,393; 3,635; and 5,549 individual cells for mammary gland 3m; 18m and 21m, respectively. e , Marrow precursor B cell relative abundances change significantly with age (p-value<0.05 and r 2 >0.7 for a hypothesis test whose null hypothesis is that the slope is zero, using two-sided Wald Test with t-distribution of the test statistic). f, Top 20 upregulated and downregulated genes in marrow computed using MAST 57 , treating age as a continuous covariate while controlling for sex and technology. Genes were classified as significant under an FDR threshold of 0.01 and an age coefficient threshold of 0.005 (corresponding to ~10% fold change). n=3,027; 8,559; 11,496; 5,216; 12,943 and 13,496 individual cells for marrow 1m; 3m; 18m; 21m; 24m and 30m, respectively. g , Skin keratinocyte stem cell relative abundances change significantly with age (p-value<0.05 and r 2 >0.7 for a hypothesis test whose null hypothesis is that the slope is zero, using two-sided Wald Test with t-distribution of the test statistic). h , Top 20 upregulated and downregulated genes in skin computed using MAST 57 , treating age as a continuous covariate while controlling for sex and technology. Genes were classified as significant under an FDR threshold of 0.01 and an age coefficient threshold of 0.005 (corresponding to ~10% fold change). n=2,346; 1,494; 4,352= and 1,122 individual cells for skin 3m; 18m; 21m and 24m, respectively. The p-values for the cell type compositional changes are shown in Supplementary Table 5 .

a , Liver hepatocyte relative abundances change significantly with age (p-value<0.05 and r 2 >0.7 for a hypothesis test whose null hypothesis is that the slope is zero, using two-sided Wald Test with t-distribution of the test statistic). n=2,791; 2,832; 3,806; 2,257; 6,384 and 5,713 individual cells for liver 1m; 3m; 18m; 21m; 24m and 30m, respectively. The p-values for the cell type compositional changes are shown in Supplementary Table 5 . b-d, Brightfield imaging of hepatocytes across age ( b ) and respective quantification ( c-d ). e , Top 10 upregulated and downregulated genes in liver computed using MAST 57 , treating age as a continuous covariate while controlling for sex and technology. Genes were classified as significant under an FDR threshold of 0.01 and an age coefficient threshold of 0.005 (corresponding to ~10% fold change). The sample size is the same as for panel a . f,k, Gene expression of Il1b and Clec4f ( f ) and Pecam1 and Mrc1 ( k ) in the liver droplet dataset for the six ages. g-j, Staining of Kupffer cells across age ( g ) and respective quantification ( h-j ). l-o, Staining of liver endothelial cells across ages ( l ) and respective quantification ( m-o ). The white scale bar corresponds to 100µm. For panels c-d , h-j and m-o , all data are expressed as mean ± s.d. and p-values were obtained using a Welch’s test. The sample size for each group is available in Supplementary Table 7 .

a,b , Mean number of somatic mutations in genes and ERCC spike-in controls across all tissues per age group (3m and 24m ( a ), 3m and 18m ( b ), 18m and 24 ( c )). Mutations are presented as the mean number of mutations per gene or ERCC spike-inn per cell.

a,b,c , Gene raw expression and ERCC spike-inn control raw expression across all tissues per age group (3m and 24m ( a ), 3m and 18m ( b ), 18m and 24 ( c )). Raw expression are presented as the mean number of counts per gene or ERCC spike-inn control per cell.

a , B-cell clonal families. For each time point, the clonal families are represented in a tree structure for which the central node is age. Connected to the age node there is an additional node (dark gray) that represents each animal and the clonal families are depicted for each animal. For each clonal family, cells that are part of that family are colored by the organ of origin. b , T-cell clonal families. For each time point, clonal families are represented in a tree structure for which the central node is age. Connected to the age node there is an additional node (dark gray) that represents each animal and the clonal families are depicted for each animal. For each clonal family, cells that are part of that family are colored by the organ of origin.

a,b , Heatmap summary of the overall tissue diversity score for FACS ( a ) and droplet ( b ). c,d , Heatmap summary of the tissue cell-type diversity score for FACS ( c ) and droplet ( d ).

a,b, Diversity score at different cluster resolutions for FACS brain myeloid microglia cell ( a ) and droplet kidney macrophage ( b) . n = 14 mice for a and n = 16 mice for b . All data are expressed as quantiles. The p-values were obtained using a linear regression and two-sided F-test, adjusted for multiple comparison using the Benjamini-Hochberg procedure (i.e., bh-p value). c,d , Diversity score correlation with the number of genes expressed per tissue ( c ) or tissue cell-type ( d ). The red line corresponds to the linear regression curve. e , Trajectory analysis for brain myeloid microglia cell. f , Heatmap showing differential gene expression analysis of cluster 10 (mostly young macrophages) versus clusters 13 (mostly old macrophages). For the complete gene list please refer to Supplementary Table 10 .