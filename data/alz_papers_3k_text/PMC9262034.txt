# Title
Disease-associated astrocytes in Alzheimer’s disease and aging

# Abstract
The role of non-neuronal cells in Alzheimer’s disease (AD) progression has not been fully elucidated. Using single-nucleus RNA-seq, we identified a population of disease associated astrocytes (DAAs) in an AD mouse model. The DAA population appeared at early disease stages and increased in abundance with age. We discovered that similar astrocytes appeared in aged wild-type mice and in aging human brains, suggesting their linkage to genetic and age-related factors.

## Accession codes.
Raw and processed mouse sequencing data that support the findings of this study have been deposited in the Gene Expression Omnibus (GEO) database under accession number GSE143758 and also available at https://singlecell.broadinstitute.org/single_cell/study/SCP302/mouse-alzheimers-and-disease-astrocytes . Code is available at: https://github.com/naomihabiblab/5xFADs-NucSeq .

## Methods
Heterozygous 5XFAD transgenic mice 12 (Tg6799; on a C57/BL6-SJL background) co-overexpress mutant forms of human APP associated with familial AD, the Swedish mutation (K670N/M671L), the Florida mutation, (I716V), and the London mutation (V717I). The study included single nuclei RNA-seq (sNuc-seq) profiles of samples from WT and 5xFAD male mouse hippocampi across six different age groups: 1.5–2 (n=6 mice), 4–5 (n=4), 7–8 (n=10, 12 samples), 10 (n=2), 13–14 (n=6), and 20 (n=2, WT only) month, as well as 5xFAD and WT 7 month old female mouse hippocampi (n=2), WT and 5xFAD male mouse prefrontal cortex (7 month, n=2, 10 month, n=2, same mice used for profiling the hippocampus) ( see Supplementary Table 1 ). Throughout the study, WT controls in each experiment were non-transgenic littermates from the same mouse colony. Additional 5xFAD and WT 7-month old mice were used for immunohistochemistry validations.

Animals were bred and maintained by the Animal Breeding Center of the Weizmann Institute of Science. Animal handling complied with the regulations formulated by the Institutional Animal Care and Use Committee (IACUC) of the Weizmann Institute of Science. Mice were anaesthetized by intraperitoneal injection of ketamine (100 mg/kg) and xylazine (10 mg/kg), and tissue dissection was performed immediately. Tissue was frozen after dissociation and kept in −80 o C until further processing.

Working on ice throughout, hippocampus tissue was transferred into a dounce homogenizer (Sigma Cat No: D8938) with 2mL of EZ Lysis Buffer (as in 11 , Sigma-Aldrich: NUC101–1KT) or NP40 Lysis Buffer (as in 21 , 0.1% NP40, 10mM Tris, 146mM NaCl, 1mM CaCl 2 , 21mM MgCl 2 , 40U/mL of RNAse inhibitor). Tissue was carefully dounced while on ice 22 times with Pestle A followed by 22 times with Pestle B, then transferred to a 15mL conical tube. Next, 3mL of lysis buffer was added to the dounce homogenizer, to rinse residual nuclei, and the suspension was transferred to a 15mL tube at a final volume of 5mL. When using EZ, the lysis homogenate was incubated on ice for 5 mins, for NP40 buffer no incubation was done. The samples were centrifuged with a swinging bucket rotor at 500g for 5 mins at 4°C. Supernatant was removed and the pellet was resuspended in 100 μl of ice cold PBS (for EZ lysis) or Tris buffer (for NP40 lysis, 10mM Tris, 146mM NaCl, 1mM CaCl 2 , 21mM MgCl 2 ) , + 0.04% BSA (NEB B9000S) and 40U/mL of RNAse inhibitor. 40μ m FlowMi cell strainers were pre-wetted with 200μ l of ice cold PBS and the resuspended nuclei were gently filtered through the FlowMi into 1.5mL Eppendorf tubes. Nuclei were counted using the Nexcelom Cellometer Vision and a DAPI stain. DAPI was diluted to 2.5μ g/μ l in PBS and 20μ l of the DAPI was pipette mixed with 20μ l of the filtered nucleus suspension, then 20μ l of the stained nuclei were pipetted into the Cellometer cell counting chamber (Nexcelom CHT4-SD100–002). Nuclei were counted using a custom program with dilution factor set to 2. Finally, 10,000 nuclei were used as input to 10X Genomics single-cell 3’ Gene Expression v2 assay (22 samples) or v3 assay (10 samples) ( Supplementary Table 1 ).

Libraries were prepared following the manufacturer’s protocol. Briefly, single nuclei were partitioned into Gel Beads in Emulsion (GEMs) in the GemCode/Chromium instrument with cell lysis and barcoded reverse transcription of RNA, followed by amplification, shearing and 5′ adaptor and sample index attachment. cDNA was amplified for 12 cycles, and the resulting WTA measured by Qubit HS DNA (Thermo Fisher Scientific: Q32851) and quality assessed by BioAnalyzer (Agilent: 5067–4626). The WTA material was diluted to <8ng/μ l and processed through v2 or v3 library construction, according the manufacturer’s protocol. The resulting libraries were quantified again by Qubit and BioAnalyzer. Libraries were pooled and sequenced on 2 lanes of Illumina HiSeqX by the Broad Institute’s Genomics Platform (22 samples) or on 2 lanes of NextSeq 500 by the Hebrew University Genomics Platform (10 samples).

De-multiplexing, alignment to the mm10 transcriptome and unique molecular identifier (UMI)-collapsing were performed using the Cellranger toolkit (version 2.1.1, chemistry V2, or version 3.0.2, chemistry V3) provided by 10X Genomics for chemistry Single Cell 3’, and run using cloud computing on the Terra platform ( https://Terra.bio ). Since nuclear RNA is expected to include roughly equal proportions of intronic and exonic reads, we built and aligned reads to genome references with pre-mRNA annotations, which account for both exons and introns. For every nucleus, we quantified the number of genes for which at least one read was mapped, and then excluded all nuclei with fewer than 400 detected genes. Genes that were detected in fewer than 10 nuclei were excluded. Expression values E i , j for gene i in cell j were calculated by dividing UMI counts for gene i by the sum of the UMI counts in nucleus j , to normalize for differences in coverage, and then multiplying by 10,000 to create TPM-like values, and finally computing log 2 (TP10K + 1) (using the NormalizeData function from the Seurat 22 package version 2.3.4).

Selection of variable genes was performed as previously described in Haber et al. (Haber et al. 2017) and adapted from Brennecke et al. 23 . Briefly, we fit a logistic regression to the nuclear detection fraction, using the total number of UMIs per nucleus as a predictor. Outlier genes expressed in a lower fraction of nuclei than expected were chosen as the variable genes, using a threshold of p-value of 0.05. In order to minimize batch effect, variable genes were found for each batch independently, and their intersection was then used as the variable genes for downstream analysis. We restricted the expression matrix to this subset of variable genes, which was used for batch correction and scaling. For the integrated analysis of the time course data, brain regions and sex comparisons, we used the integrated workflow of Seurat 22 V3, including finding variable genes by using the function FindVariableFeatures (setting the selection method to vst and the number of features to 2000).

For the 7-month old mouse dataset, batch correction was done using ComBat ( ComBat 24 function from the sva package in R) on the normalized data set. The batch-corrected data were scaled using the ScaleData function from the Seurat 22 with default parameters (version 2.3.4), yielding the relative expression of each gene by scaling and centering. The scaled data matrix was then used for dimensionality reduction and clustering. To rule out the possibility that the resulting clusters were driven by batch or other technical effects, we examined the distribution of samples within each cluster and the distribution of the number of genes detected across clusters (as a measure of nucleus quality). Overall, the nuclei separated into distinct point clouds in tSNE space that were not driven by batch; each cluster/cloud was an admixture of nuclei from all technical and biological replicates, with variable numbers of genes. Related to the number of genes, we note that there was a distinct biological difference in the number of transcripts (and expected RNA content) between neuronal and glial cells in the brain.

We used the scaled expression matrix restricted to the variable genes for principal component analysis (PCA), using RunPCA method in Seurat (a wrapper for the irlba function), computing the top 50 PCs. After PCA, significant principal components (PCs) were identified using the elbow method, plotting the distribution of standard deviation of each PC ( PCElbowPlot function in 22 ), choosing 25 PCs for analysis of all cells, 15 PCs for astrocytes (across all analysis, 7-month-old mice, time course astrocyte, female/male, brain regions, human data). Scores from only significant PCs were used as the input to downstream clustering, visualization by tSNE or UMAP 26 and diffusion map modeling. Clustering the nuclei into transcriptionally similar clusters was done using a k -nearest neighbor ( k -NN) graph, followed by the Louvain community detection algorithm 25 , using the top significant PCs as input to a graph-based clustering algorithm, as previously described 11 , with small modifications and improvements. Briefly, in the first step, we computed a k -nearest neighbor ( k -NN) graph, connected each nucleus to its k -nearest neighbors (based on Euclidean distance), then used the k -NN graph as an input to the Louvain algorithm, which decomposes an input graph into communities. We used k =40 for clustering of each full dataset, with varying resolutions from 0.9 to 1.2. For the full dataset across all cell types, at the final stage, cells were hierarchically clustered and re-ordered (using BuildClusterTree method the Seurat package, given the same set of variable genes as input to the PCA analysis), providing the cluster ordering described throughout this study.

For visualization, the dimensionality of the datasets was further reduced using the same top PCs as input to t-Distributed Stochastic Neighbor Embedding (t-SNE, using the runTSNE methods which runs the Barnes-hut approximation of tSNE running the Rtsne function ), or Uniform Manifold Approximation and Projection (UMAP 26 ) dimensionality reduction technique (using the RunUMAP method which uses the umap-learn Python package). Cell populations were matched to cell types based on the expression of known marker genes and previously identified expression signatures 11 , 27 . Recently activated neuronal populations were identified based on expression of immediate early genes, such as Egr4.

To identify subtypes of cells within the astrocyte populations, the same analyses described above were performed, but limited to all nuclei classified by their cluster identity as astrocytes. Astrocytes were identified by marker gene expression including high expression of Slc1a3, Gfap, Aldoc and Glul, and low/no expression of Rarres2 and Slc6a13. As shown in Extended Data Fig. 2 , the expression of Slc1a3, Gfap, Rarres2 and Slc6a13 is sufficient to uniquely identify the clusters of astrocyte cells (excluding clusters of doublet cells). Specifically, for the 7 month hippocampus male mouse dataset, astrocyte clusters 1 and 2 from Figure 1b were combined and used in all the downstream analysis.

To model continuous transitions in astrocyte states, we calculated the diffusion components for all astrocytes (applied on the 7-month-old dataset or on the combined time course datasets). The diffusion components were calculated using the cell embedding values in the top 15 principal components (PCs) (generated on either the scaled expression matrix restricted to the variable genes in the 7-month old mouse dataset or on the aligned CCA subspace for the entire time course data), using the DiffusionMap function from the destiny 28 package in R (with a k =30 and a local sigma). We then chose the top two diffusion components (DCs) for data visualization (other combinations of components revealed similar continuous trajectories, as shown in Extended Data Fig. 3d ).

For doublet detection and elimination, we used the Scrublet 29 method over a random subset of 30,000 nuclei to identify clusters of doublets. Scrublet identifies heterotypic doublets comprised of two different cell types by simulating doublets and building a nearest neighbor classifier. Scrublet was run with the following parameters: k =30 for the k -NN graph, doublet simulation rate of 0.3 and an expected doublet rate of 0.1. Nuclei receiving Scrublet scores over 0.25 were classified as doublets. We then clustered our data at high resolution (resolution parameter = 2.5), generating 39 clusters, and found multiple small clusters that had over 70% of nuclei classified as doublets, which we then excluded from downstream analysis. We validated that these clusters are “doublet clusters” based on a traditional inspection of expression patterns of cell type marker genes, showing that they co-express markers of at least two different cell types (the main markers we use in these inspections are shown in Extended Data Fig. 2 ). Notably, some clusters, such as the fibroblast cells, could have been misclassified as a doublet cluster based on the marker gene approach alone, since they express markers of several other cell types, demonstrating the importance of a computational approach that does not depend entirely on prior knowledge. In the downstream analysis of astrocytes, a second inspection for doublets was done using the traditional inspection of expression patterns of cell type marker genes. Specifically, this was done in the cortex and the female datasets before integration, removing small clusters highly expressing neuronal cell markers (such as Meg3).

The change in fraction of the different cell populations (clusters) was separately computed for each mouse/sample across all clusters, as the fraction of nuclei in each cluster, out of the total number of nuclei. To assess statistically significant changes in a fraction of a specific population, we first performed the Shapiro-Wilk test for normality (using the shapiro.test function in R), followed by paired t-test (for normally distributed populations) and an additional paired non-parametric Wilcoxon test (using t.test and wilcox.test functions in R). Results with p-value<0.01 were reported as significant.

Differentially expressed signatures were calculated using a negative binomial test and controlled false-discovery rates (FDR) using the Benjamini-Hochberg procedure, to find genes that are upregulated within each cluster compared to the rest of the nuclei in the dataset or between pairs of clusters, including genes with less than FDR 1%. Genes were required to be expressed in at least 10% of nuclei in the given cluster, and at least 0.3-fold less in all other cells.

The differential expression signatures were tested for enriched pathways and gene sets, using a hypergeometric test (function enrichment in the bc3net package in R), and corrected for multiple hypotheses by FDR. Results with FDR < 0.05 were reported as significantly enriched pathways. Gene sets and pathways were taken from the MSigDB/GSEA resource (combining data from Hallmark pathways, KEGG, Reactome, PID, Canonical Pathways and GO biological process) 30 . Gene signatures of reactive astrocytes were obtained from Zamanian et al . 6 and Liddelow et al . 5 .

Scoring gene signatures across cells, was done by following a procedure adapted from Smillie et al. 31 . Briefly, we compute for every cell the log transformed geometric average of expression values of all genes in the signature was computed, using the scaled log normalized data matrix of UMI counts. To correct for highly expressed genes, the log-transformed geometric mean of a random set of genes of with similar expression levels was then subtracted.

To compare intermediate (cluster 3), Gfap-high and DAA states, we identified genes upregulated in each of the three states vs . the homeostatic astrocytes (cluster 1) and performed pathway analysis as described above. We then combined the FDR q-values across the union of all enriched pathways, using a threshold of FDR<0.05. Enriched pathways with higher FDR values were marked as non-significant.

The list of DAM up-regulated genes compared to the homeostatic microglia was taken from the literature (Supplementary table 2 in Keren-Shaul et al . 1 ), and the DAM signature was defined as all genes with fold change greater than 1.2, and -log FDR > 3.3 resulting in 213 genes. Genes were filtered to include only genes found to be detected in the sNuc-seq data (retaining a total of 152 genes). All cells in our dataset from WT and AD mice were scored for the DAM signature (as described above for scoring gene signatures ), and the distribution of scores was compared. To identify overlaps in the DAA and DAM signatures, we used the differentially expressed genes in DAA (cluster 4) compared to the homeostatic state (cluster 1, following the procedure defined above for Differential expression) . Display of gene-gene functional links within the shared DAM-DAA signature genes, were done using the STRING database 32 , setting edges to reflect the confidence of the prediction, based on the following categories: co-expression, databases, text mining and experiments.

Comparison of astrocyte profiles across two groups ( i.e. sex , in Extended Data Fig. 4a - d , or brain regions, in Extended Data Fig. 4e - i ), was done by integrated clustering of cells from the two groups ( i.e. males and females or hippocampus and cortex samples), and annotating the de novo clusters by projecting the astrocyte clusters defined for the hippocampus of 7-month old male mice (from Fig. 1d ). These annotated clusters were used to identify DAAs, homeostatic Gfap-low and Gfap-high astrocytes in female mice and in the cortex brain region, and to compare the relative abundance of astrocyte states between AD and WT mice across sex and brain regions. This was done by the following steps: We first identified the astrocyte cells in each of the additional datasets: sNuc-seq profiles of cortex brain region or of female hippocampus region ( Supplementary Table 1 ), were analyzed following the procedures for normalization, scaling and clustering described above in the section “ Dimensionality reduction, clustering and visualization” (using Seurat V.3). Astrocyte clusters were identified by marker genes expression (as described above) and selected for further analysis.

To compare the astrocyte cell states across regions and sex, we combined the astrocyte cells (from female mice or male cortex) with sNuc-Seq profiles from four 7-month-old mouse hippocampi ( Supplementary Table 1 ). Datasets were combined and batch corrected by anchor based joint canonical correlation analysis (CCA) 22 , 33 , Using Seurat V3 , we first normalized each dataset separately (log-transform) and found variable genes (using the function, FindVariableFeatures, setting the parameters: selection.method to vst and nfeatures to 2000). We then searched for integration anchors, which are pairwise correspondences between individual cells, with the underlying assumption that cells originating from the same biological state will be matched (using the function FindIntegrationAnchors, over the first 20 dimensions). We integrated the data using this list of anchors (using the function IntegrateData). Following the data integration, the integrated expression matrix was analyzed by repeating the standard analysis steps on the integrated expression matrix: data scaling, PCA, clustering and 2-D tSNE embedding for visualization. The top 15 PCs were used for the clustering and tSNE embedding.

To annotate the clusters, we used a similar analysis, based on the CCA 22 , 33 approach (using Seurat V3 ), to project the cluster IDs from the 7-month-old mouse dataset (IDs as in Figure 1d ) to the integrated set. We set the 7-month-old male mouse clusters as a reference, and predicted the cluster identity of all other cells (of different sex or brain regions), using the functions FindTransferAnchors and TransferData (in Seurat V3). Each cluster in the integrated dataset was matched to one (or two) of the astrocyte states (homeostatic Gfap-low, Gfap-high, DAA state, intermediate-sate DAA and Gfap-high intermediate state) by a majority vote within all cells in the cluster, while ambiguous results were not matched with any state. Finally, the fraction of astrocytes across clusters/states was calculated for each mouse, comparing the relative frequencies of the DAA, homeostatic Gfap-low and Gfap-high clusters in matching pairs of WT and 5xFAD mice. The CCA integrated analysis was used to enable comparison of astrocyte states, while excluding technical batch effects (differences between 10x versions), sex-specific expression patterns, or regional biases (such as regional specific ambient RNA). It is of note that not all cells in the comparison matched the original dataset of 7-month old male mice hippocampi. For example, the homeostatic astrocytes split to separate clusters between the cortex and hippocampus brain regions, while the DAAs and Gfap-high cells clustered together across brain regions. Thus, when using the CCA approach, we were able to identify distinct expression profiles in astrocytes (across brain regions), and also to identify shared expression profiles, such as DAAs astrocytes in female 5xFAD mice and in the cortex of 5xFAD mice.

For comparison of expression profiles of clusters across region or sex, we used the top marker genes, identified for the 7-month male hippocampus mice (as in Fig. 1e ), of the three major astrocyte states, DAAs, homeostatic Gfap-low and Gfap-high.

Immunohistochemistry was performed on mouse brain sections. Mice were perfused with PBS prior to brain tissue fixation, followed by tissue processing to form 30μ m-thick floating sections. The following primary antibodies were used: rabbit anti-GFAP (1:150; Dako #Z0334 #LOT 20056262), chicken anti-VIM (1:150; Abcam #24525, # LOT GR3216660–15), goat anti-serpinA3N (1:200; R&D systems #AF4709-SP,# LOT CBKW0318051), mouse anti-Aβ 1–16 (1:150; Biolegend #803001 #LOT B247600). Secondary antibodies were Cy2/Cy3/Cy5 donkey anti- rabbit/chicken/goat/mouse antibodies, respectively (1:150; Jackson ImmunoResearch). Staining with secondary antibody alone was used to rule out nonspecific staining. The following secondary antibodies were used: Cy2/Cy3/Cy5 donkey anti- rabbit/chicken/goat/mouse antibodies, respectively (1:150; Jackson ImmunoResearch. As reported in the Reporting Summary Document: 711–225-152, cy2 Donky anti Rabbit, lot 142845; 715–225-150, Cy2AffiniPure Donkey Anti-Mouse; lot 142843; 705–225-147, Cy2-AffiniPure Donkey Anti-Goat IgG; lot 122781; 711–165-152, Cy3 Donkey anti Rabbit, lot 143202; 715–165-151, Cy3AffiniPure Donkey Anti-Mouse IgG, lot 143017; 705–165-147, Cy3 Donkey Anti-Goat, lot 143201; 715–175-151, Cy5-AffiniPure Donkey Anti-Mouse IgG, lot 144119; 711–175-152, Cy5-AffiniPure Donkey Anti-Rabbit IgG, lot 144221; 705–175-147, Cy5-AffiniPure Donkey AntiGoat, lot 134531;). For nuclear staining, Hoechst was used (1:4000; Invitrogen Probes) for 30s prior to sealing of the slides. Confocal microscopy was used for analysis (Zeiss, LSM880). Representative images were merged and optimized using ImageJ (Java.version: 1.8.0_66).

The time course dataset consisted of four datasets (or batches), a 7-month old mice dataset (including 4 5xFAD and WT mice from the dataset in Figs. 1 and 2 of samples prepared with EZ lysis buffer to match the conditions in the other time points), and three additional datasets from 5xFAD and WT mice ranging in age from 1.5 to 20-month old 5xFAD and WT mice ( Supplementary Table 1 ). Each dataset in the time course was analyzed separately, repeating the analysis steps described for the 7-month-old mice. Clusters of astrocytes or microglia were selected from each batch for further analysis.

For microglia, the fraction of microglia cells was calculated for each sample out of the total number of cells, and compared across ages and conditions, matching pairs of littermates AD and WT mice that were processed at the same sequencing batch.

For astrocytes, data across all 4 batches were combined and batch corrected by anchor based joint CCA 22 , 33 , using Seurat V3 , as described for Comparison across brain regions and sex by CCA integrated analysis . Following the data integration, the integrated expression matrix was analyzed by repeating the standard analysis steps on the integrated expression matrix: data scaling, PCA, clustering and 2-D tSNE embedding for visualization, as well as diffusion map modeling, using the top 15 PCs for clustering, tSNE and diffusion map steps). The diffusion map embedding of the time course dataset aligned cells along two continuous trajectories, a Gfap-low to Gfap-high trajectory and a homeostatic-DAAs trajectory (shown in Extended Data Fig. 7 ), which matched the trajectories found for the 7-month old mice ( Figure 1d ). Notably, for consistency and clarity reasons, in Fig. 3 we show the embedding of the time-course datasets in the diffusion map of the 7-month old mice (as in Fig. 1d , which was done as described in the section Dynamic modeling, k-nearest neighbors embedding and gene expression dynamics ).

To computationally model dynamic transitions between astrocyte cell states along disease progression, we assigned a unique “origin cell” for each astrocyte in AD. This was done using the Hungarian algorithm 34 (munkres function in MATLAB) by globally optimizing the pairwise distances, in the PCA or CCA space, between all AD astrocyte cells and their matched neighbors, selected from all AD cells at the preceding time point or among all other AD cells outside its cluster. We predicted origin cells for both reference sets to capture the dynamics in astrocyte states along different stages of the disease as well as the continuous range of astrocytes within a given time point. The predictions of origin cells were used to: (1) map the trajectory of AD cells along disease stages in the diffusion space using force fields; (2) predict the source population of the DAAs by quantifying the transitions between clusters; (3) find putative genes underlying the transitions in astrocyte states. For assigning the “origin” cells, we searched for the optimal assignment of AD astrocytes, by globally minimizing the sum of pairwise Euclidean distances in the PCA/CCA space between all pairs of cells and their assigned origin cell. For each AD time point (or AD cluster), we searched for the globally optimal assignment between all AD cells at a given time point (or a given cluster) and all other AD cells at a preceding time point (or all other AD cells outside the cluster), which we termed “origin” cells.

We devised a new computational approach to identify the genes most strongly associated with the transitions in astrocyte states. To this end, we first computed the average trajectory (in the PCA/CCA space) of cells from each AD cluster to every other AD cluster (between time points or within a given time point). We then correlated the average trajectory with the PCA/CCA loading values of each gene to identify genes that are up or down regulated in the transition from one state to the other. Genes with significant Pearson correlation (FDR<1e-2) were marked as putative marker genes for each transition.

Importantly, diffusion map analysis of the time course data aligned the astrocytes along trajectories similar to the ones identified in the 7-month dataset, in which astrocytes traverse a homeostatic-to-Gfap-high trajectory and a homeostatic-to-DAA trajectory (as shown in Extended Data Fig. 7 ). However, for visualization and annotation purposes, we embedded the time course data into the diffusion map of the 7-month dataset ( Fig. 1d ) using a k -nearest neighbor approach. To embed each cell in the 7-month diffusion space, we first identified the k nearest nuclei within the CCA space (K=10), and calculated their relative Euclidean distances d i . We then calculated the relative normalized weights for each of the k neighbors, as: w i α 1 d i 2 such that ∑𝑤 i = 1, and calculated the estimated position Y ^ i of that nucleus within the 7-month diffusion space as a weighted average Y ^ i = Σ w i X i of the positions of the k neighboring nuclei ( X i ). Similarly, we predicted the cluster IDs (as in Figure 1d ) of embedded cells using a weighted majority vote based on the cluster IDs of their k neighbors, using the same relative normalized weights as above.

Finally, we computed the relative trajectory of each nucleus from its “origin” cells (or embedded position Y ^ i ) to its position Y i in the diffusion space, and visualized this trajectory as a directed arrow using force fields (quiver function in MATLAB). To validate robustness, the same analysis was done comparing AD cells to all WT cells in the 7m dataset across all cells, or to all WT and AD cells outside the cluster, per each cluster.

The count matrix of sNuc-Seq data from human astrocytes was obtained from Mathys et al. 4 , using the published cluster annotations to select all astrocyte cells. To compare the human and the mouse astrocytes, mouse genes were first mapped to human genes, using annotations from the UCSC genome browser (for mouse mm10 genome). The human data were re-analyzed following the steps described above for normalization, variable genes detection, scaling, clustering and visualization (using Seurat V3). Finally, cluster identity was assigned to the human clusters using the CCA approach (Seurat V3), with the data and cluster IDs of 7-month old male mice (as in Fig. 1d , Supplementary Table 1 ) (following the steps detailed in the section Comparison across brain regions and sex by CCA integrated analysis ). The cluster of human astrocytes with the highest identity to the mouse DAAs cluster, was termed DAA-like. The fraction of astrocytes assigned to each of the mouse clusters out of all astrocytes, was calculated for each individual, and split to show the distributions in healthy individuals and individuals with Alzheimer’s disease. For comparison of human and mouse expression signatures, we chose top marker genes from the mouse. Notably, while a single human cluster showed the highest similarity to the mouse DAAs, more than one human cluster could be associated with the mouse DAAs by the predicted cluster IDs and by the expression of marker genes ( Extended Data Fig. 9 , Fig. 3i ), suggesting high diversity of astrocyte states in the human brain.

Sample size, data exclusion and randomization: The main dataset consisted of 4 WT and 4 transgenic 5xFAD mice, based on published results by us and other groups, showing high consistency in single nucleus RNA-seq libraries between mice, but due to technical variability it is recommended to have at least 3 animals per group. The time course data had additional 12 WT and 10 5xFAD animals across time points. Immunohistochemistry was repeated, for every set of antibodies, over n=4 AD and WT mice, with 4 brain slices per animal. No statistical methods were used to pre-determine sample sizes but our sample sizes are similar to those reported in previous publications 3 , 11 , 21 , 27 , 35 . Number of nuclei per animal was determined to enable detection of rare populations around 2% of all cells (calculated based on our previous data in the mouse brain 11 , 21 ). No sample or animals were excluded from the analysis. As commonly done, nuclei libraries were filtered using previously established methods: nuclei with fewer than 400 detected genes were excluded from the analysis. Animals were assigned randomly to the various experimental batches according to their age, while matching transgenic Alzheimer’s model 5xFAD animals with WT non-transgenic litter-mate from the same mouse colony and age. Notably the clustering analysis and specifically the identification of the different astrocyte populations, was done blindly to the animal strain, sex and age.

Several statistical tests were used throughout this work, as mentioned in each relevant section. These tests can be divided to the following tasks: (1) Finding statistically significant changes in fraction of cellular populations between WT and 5xFAD mice: We first performed the Shapiro-Wilk test for normality. On normally distributed cellular populations we used the two-sided paired t-test and for non-normally distributed samples we used the paired non-parametric two-sided Wilcoxon test (matching mice by experimental batch and litter mate). In both cases, tests were applied to n=8 animals (10 samples), and cellular populations with p-value <0.01 were reported. The number of cells per population varied (as shown in Fig. 1 and Extended Data Fig. 1 ). (2) Identifying differentially expressed genes between clusters: Negative binomial test and controlled false-discovery rates (FDR) using the Benjamini-Hochberg procedure, between pairs of clusters. For Figure 2a and Supplementary Table 2 : n=8 animals, FDR<1%, and genes were required to be expressed in at least 10% of nuclei in the given cluster, and at least 0.3-fold less in all other cells, as routinely done. Data distribution was estimated to be negative binomial, though this assumption might not fit every gene. (3) Finding enriched pathways. Done by calculating the hypergeometric p-value and controlled false-discovery rates (FDR) using the Benjamini-Hochberg procedure (all gene-sets used are reported above). For Figure 2b and Supplementary Table 3 : n=8 animals and a threshold of FDR<5%. (4) Testing for consistent changes in cell frequency across ages we used linear regression, computing a confidence interval per time point. Calculated with: n=12 5xFAD animals or n=16 WT animals across ages, for each astrocyte state (reporting the R value and p-value). (5) Identify the genes associated with the transitions in astrocyte states, we used our new procedure described above. Briefly, we find genes that are statistically significant (p-value controlled for false-discovery rates (FDR) using the Benjamini-Hochberg procedure <0.001) correlated with the direction of average trajectory by computing the Pearson correlation coefficient. This was done using n=12 animals, and 10,226 cells from 5xFAD mice across ages. Additional information can be found in the Life Sciences Reporting Summary .

## Data and Code Availability.
Raw and processed mouse sequencing data that support the findings of this study have been deposited in the Gene Expression Omnibus (GEO) database under accession number GSE143758 and also available at https://singlecell.broadinstitute.org/single_cell/study/SCP302/mouse-alzheimers-anddisease-astrocytes . Code is available at: https://github.com/naomihabiblab/5xFADs-NucSeq .

## Extended Data
(a) Doublet detection and elimination. 2-D tSNE embedding of 60,818 single nuclei RNA profiles from hippocampus of four WT and four 5xFAD 7- month old mice, before filtration. Top: Color coded by cluster assignment. Bottom: Color coded by doublet score assigned per cell by the Scrublet1 software, used to infer doublet cells and clusters to exclude from the analysis. (b) Number of genes and transcripts across clusters. Violin plots showing the distribution of number of genes (top) and transcripts (unique UMIs, bottom) detected in each cluster (n=8 mice, 10 samples). Cluster numbers as in Fig. 1b . (c) 2-D tSNE embedding of single nuclei RNA profiles from hippocampus of WT and 5xFAD mice (as in Fig. 1b ), colored by (from left to right): batch, mouse strain (WT or AD) and sample. (d) Similar distribution of samples and batches across clusters. The percent of cells per cluster, in WT and 5xFAD mice. Middle: Colored by batch/lysis buffer (red= EZ lysis. Blue = NP40 lysis, Methods ), Right: Colored by sample (blue color scale, 4 animals and 5 samples per mouse strain, AD or WT). Left: The hierarchical cluster tree and annotations of clusters, as in Fig. 1b .

(a) Expression of marker genes across clusters. 2-D tSNE embedding of single nuclei RNA profiles from hippocampi of WT and 5xFAD mice (as in Fig. 1b ), colored by expression levels of marker genes: Grin2b (neurons), Gad2 (GABAergic neurons), Vcan (Oligodendrocytes precursor cells, OPCs), Hmha1 (microglia), Flt1 (endothelial), Vtn (pericytes), Plp1 (oligodendrocytes), Slc1a3 (astrocytes), Gfap (astrocytes), Rarres2 (ependymal/NPCs), Slc6a13 (fibroblasts), Homer1 (immediate early gene, IEGs). ( b ) Clusters and marker genes. Dot plot showing the expression level (color scale) and the percent of cells expressing (dot size) marker genes across all clusters (rows). Cluster numbers as in Fig. 1b . (c) Disease associated microglia (DAM) signature enriched in AD. Violin plots showing the distribution in WT (n=8 animals, 896 cells) and AD (n=8 animals, 1,540 cells) of microglia expression scores for signatures of genes up-regulated in DAM compared to homeostatic microglia (from keren-Shaul et al . 2 , Methods ). Expression score per cell is the geometric mean normalized expression level (TPMs) across all signasture genes, corrected by subtraction of the geometric mean expression of a random set of genes of similar expression levels ( Methods ). ( d ) Recently activated pyramidal neurons. Left: Dot plot as in (c) showing the expression of immediate early genes (IEGs) across all clusters (as in Fig. 1b ), showing cluster 23, capturing pyramidal neurons expressing IEGs. Right: tSNE plot of all cells, color coded by the expression level of the Egr4 gene in CA3/CA1/Subiculum (cluster 23), and DG excitatory neurons (part of cluster 12). (e) Cell type specific markers. Dot plots showing the expression level (color scale) and the percent of cells expressing (dot size) genes across all clusters (rows, as in Fig. 1b ), showing markers found to be specific to cells classified as (from left to right): ependymal/NPCs, fibroblasts and pericytes.

(a) 2-D Umap 3 embedding of 7,345 single nuclei RNA profiles of astrocytes (as in Fig. 1d ) from hippocampus of 4 WT (left) and 4 5xFAD (AD, right) 7-month old mice. Colored by cluster, all other cells in light yellow in the background. (b) 2-D Umap 3 embedding as in (a), colored by sample (left), or batch (right). (c) Number of genes and transcripts across clusters. Violin plots showing the distribution of number of genes (top) and transcripts (unique UMIs, bottom) detected per cluster (n=8 animals, total of 7,345 cells). Cluster numbers as in (a). ( d ) Diffusion maps 4 of 7,345 single nuclei RNA profiles of astrocytes in the hippocampus of WT and 5xFAD mice, showing 2-D embedding of cells in combinations of the top four diffusion components (DC), colored by mouse strain, WT (blue) and 5xFAD (AD, red). (e) Distribution of astrocyte states in WT and AD brains. Box plots showing the fraction of each astrocyte cluster (compared to total number of astrocyte cells, clusters as in Fig. 1d , n=8 animals, 10 samples), in WT and 5xFAD mice. Displaying the median (thick lines), 25% and 75% quantiles (box), and individual samples (dots).

(a) 2-D tSNE embedding of single nuclei RNA profiles of astrocytes from hippocampus of 7-month old female (1,500 nuclei, 2 mice, left) and male (5,183 nuclei, 4 mice, right) of three WT and three 5xFAD (AD) mice. Colored by cluster assignment. The three end states are marked on the graph: homeostatic Gfap-low, Gfap-high and DAA (annotated by projection of cluster IDs and expression patterns from Fig. 1d , Methods ). ( b ) 2-D tSNE embedding as in (a), colored by cluster IDs of male mice, classified as cluster 4 (DAA) and cluster 6 (Gfap-low) from Figure 1d . All other cells in grey. ( c ) Male and female astrocytes share expression of marker genes across clusters. Expression levels (as color scale) and the percent of cells expressing (as dot size) of marker genes for DAA (Ggta1, Gsn, Osmr, Vim, Serpina3n, Ctsb, Gfap), Gfap-low (Fabp7, Slc38a1, Myoc, Aqp4, Id1, Id3, Gfap) and Gfap-low (Mfge8, Slc7a10, Luzp2) across clusters, split to male (purple color scale) and female (yellow color scale) mice. ( d ) Proportion of DAAs increase and homeostatic Gfap-low astrocytes decrease in AD female mice. The proportion of astrocytes classified as Gfap-low (clusters 1,2,5,6 in (a)), DAAs (cluster 3 in (a)) and Gfap-high (cluster 4 in (a)) in male and female mice. Bar: individual mice, colored by strain and sex. ( e ) DAAs found in 5xFAD mice cortex at age 7 and 10 months. 2-D tSNE embedding of single nuclei RNA profiles of astrocytes from WT and AD mice, from the cortex of 7 and 10 month old mice (6,062 nuclei, 4 mice) and hippocampus of 7-month old mice (5,344 nuclei, 4 mice). Colored by cluster assignments: Gfap-low (three clusters split to hippocampus and cortex), Gfap-high, DAA, intermediate and other. ( f ) Similar expression patterns of marker genes in astrocytes in the hippocampus and cortex. Dot plot showing the expression level (as color scale) and the percent of cells expressing (as dot size) marker genes for DAAs, Gfap-high and Gfap-low across clusters (as in ( e )), split by brain region to hippocampus (Hip, yellow color scale) and cortex (Crtx, purple color scale). ( g ) 2-D tSNE embedding as in (e), colored by predicted cluster ID of hippocampal astrocytes from 7-month old male mice (inferred by CCA 5 , 6 projections, as in Fig. 1d , Methods ). ( h ) Cortical astrocyte populations match astrocyte states identified in the hippocampus. Heat map showing the correspondence between the de novo cluster IDs (rows, from (e)) of the cross regional dataset, and the predicted cluster IDs (columns) using the hippocampal astrocytes cluster IDs as reference (as from Fig. 1d ). Color scale based on the proportion of predicted IDs per de novo cross-regional cluster. ( i ) DAAs appear in the cortex of 5xFAD (AD) mice. The proportion of astrocytes, per sample, across clusters, including clusters of Gfap-low, DAAs, and Gfap-high astrocytes. Bars: Individual mice, color annotated by region: cortex or hippocampus (Hip), age: 7 or 10 months (m), and strain: AD or WT. (j) Astrocyte marker genes expressed in 7-month old male mice (complementary to Fig. 1e ). Left: Average expression level (color scale) and the percent of cells expressing (dot size) marker genes for: Gfap-low (Slc7a10, encoding a solute carrier transporter of D-serine and other amino acids 7 ; Trpm3, encoding a transient receptor potential M3 channel related to store-operated calcium entry in astrocytes 8 ), DAA (Ctsb, encoding a protease involved in proteolytic processing of amyloid precursor protein 9 , 10 ; Csmd1, associated with cognitive functions 11 ; C4b, encoding complement factor 4; Vim, a marker of adult neurogenesis/NSCs 12 ), common to DAA and Gfap-high (Cd9, encoding a transmembrane protein, reported to be expressed by neural stem cells like astrocytes 13 ), and Gfap-high (Sparcl1/Hevin, encoding a pro-synaptic protein in astrocytes 14 , 15 ; Aqp4, a known marker of astrocyte endfeet 16 ), for each cluster (cells and clusters as in Fig. 1e ). Right: Violin plots (n=8 animals, 10 samples), showing the expression level distributions of Csmd1 and Ctsb in WT and AD astrocytes.

(a) Differential expression across astrocyte states. Volcano plots showing differentially expressed genes in each pair of states (n=8 animals, 10 samples. y-axis:-log adjusted hypergeometric p-value, following FDR multiple hypothesis correction, x-axis:average log fold change). AD risk factor genes from GWAS marked in orange (as in Fig. 2a ). ( b ) DAAs, Gfap-high astrocytes, and cluster 3 astrocytes share multiple upregulated genes and pathways compared to the homeostatic Gfap-low astrocyte population, but also have distinct expression programs. Pathway (rows) enrichment for upregulated genes in cluster 4 (C4, DAAs, n=478 cells), cluster 6 (C6, Gfap-high, n=457), or cluster 3 (C3, intermediate state,n=1,666 cells), compared to Gfap-low astrocytes (n=1,594 cells). Enriched pathways21,22 (hypergeometric pvalue with FDR<0.05. n=8 animals, 10 samples), colored by -log FDR values (as in Fig. 2b , with full list of pathway annotations and no scaling).

(a-b) Signatures of inflammatory reactive astrocytes found in AD. Ridge plots showing the distribution of expression scores across each astrocyte cluster, for previously defined signature genes of: pan-reactive, A1, and A2 (from Liddelow et al . 17 , left), or of: pan-reactive, inflammation (LPS-induced), and ischemia (MCAO-induced) (from Zamanian et al . 18 right). Expression score per cell is the geometric mean normalized expression level (TPMs) across all signature genes, corrected by subtraction of the geometric mean expression of a random set of genes of similar expression levels. ( b ) Violin plots showing the distribution of expression scores across WT (3,831 cells, n=4 animals) and AD (3,514 cells, n=4 animals), for signature genes for: A1 and A2 astrocytes (as defined in Liddelow et al . 17 ). Scores computed as in (a). ( c ) Expression of genes from reactive, A1, and A2 signatures, showing diversity of gene patterns across astrocyte clusters. 2-D umap 3 embedding of 7,345 single nuclei RNA profiles of astrocytes in the hippocampus of WT and 5xFAD mice (as in Extended Data Fig. 3a ), colored by the gene expression level. Area of the graph with highest expression is marked in dotted black lines. Gene name on top of each graph. The signature the gene is associate with (pan reactive, A1 or A2) on the right side of each panel. ( d ) Astrocytes expressing DAA markers are present in AD brains, enriched in the subiculum and in proximity to Aβ plaques. Representative immunofluorescence images (staining repeated over n=4 AD and WT mice, with 4 brain slices per animal) in sagittal sections of 7–8-month old 5XFAD mice (with Figure 2f - h ). From top to Bottom: Subiculum, stained for GFAP (green), VIM (red), and serpinA3N (gray), (as in Fig. 2f ). Dentate gyrus (in Figure 2g , left) and subiculum (in Figure 2g , right), stained for GFAP (green), VIM (red), and Aβ (gray). Subiculum, stained for GFAP (green), serpinA3N (red), and Aβ (gray) (as in Figure 2h ). Cell nuclei are shown in blue (Hoechst). Scale bar, 50μm.

(a-b) A map of astrocyte states in WT and AD across ages. 2-D tSNE embedding of sNuc-Seq profiles of astrocytes in WT and 5xFAD (AD) mice across 6 different age groups (in months): 1.5–2 (n=6 mice), 4–5 (n=4), 7–8 (n=8), 10 (n=2), 13–14 (n=6), and 20 (n=2, WT only). (23,863 cells, from four batches, united by CCA integrated analysis 5 , 6 , Methods ). Colored by: cluster IDs (in ( a )), or predicted cluster IDs (using reference cluster IDs of astrocytes of 7-month old mice as in Fig. 1d , in ( b )). ( c ) The correspondence between the de novo cluster IDs (columns) of the time course data, and the predicted cluster IDs (rows) from astrocytes of 7-month old mice (as in Fig. 1d ). Color scale = proportion of predicted IDs per de novo cluster. ( d-g ) 2-D tSNE embedding of time course astrocytes as in (a), colored by: age ( d ), mouse strain, AD/WT ( e ), batch ( f ), or sample ( g ). ( h ) Continuous trajectory of astrocyte states across ages in WT and AD. 2-D diffusion map embedding of astrocytes across ages. Colored by de novo clusters: Gfap-low (1), Gfaplow/ intermediate (2), Gfap-high (3), and DAAs (4). 15,113 astrocyte cells, down sampled randomly from 23,863 cells to capture 2,500 cells of each age group (or the maximum number of cells available if less than 2,500). ( i ) 2-D diffusion map embedding (as in (h)), colored by predicted cluster IDs (as in (b)). ( j ) 2-D embedding of the 15,113 astrocytes of AD (left) and WT (right) cells across ages, projected onto the diffusion map of 7-month old mice (embedded by the weighted average position of the K-NN in the diffusion map in Fig. 1d , Methods ). Colored by the de novo clusters (as in (a)). (k) The expression level (as color scale) and the percent of cells expressing (as dot size) of marker genes for DAAs (Ggta1, Gsn, Osmr, Vim, Serpina3n, Ctsb, and Gfap), Gfaphigh (Fabp7, Slc38a1, Myoc, Aqp4, Id1, Id3, and Gfap) and Gfap-low (Mfge8, Slc7a10, Luzp2), across de novo clusters of astrocytes in the time course dataset.

(a-b) Direction of transition of AD astrocytes from their global optimal nearest neighbor ( origin ) cell (predicted by the Hungarian algorithm 19 , Methods ) to their given position in the diffusion map. For each cluster, force field (black arrows) marking the directionality of transitions along the diffusion map 4 (as in Figure 1d ), cells colored by cluster ID. Showing transitions from the predicted cell of origin among all WT cells or AD cells outside the cluster ( a ), or among all WT cells only ( b ) (transition from origin cells among all AD cells outside the cluster or AD cells in different clusters from a preceding time point, shown in Fig. 3 ). ( c ) Proportion of cells of origin per cluster (dot size and color) for each AD cluster (rows), from all WT cells (left) or from AD cells from all other clusters (right). ( d ) Scheme of transitions. A graph showing arrows between pairs of clusters with high proportion of origin cells (>15%) when mapping AD to all WT cells. Color and width of edge reflects the proportion. Diffusion map as in (a) in the background. ( e ) Genes correlated with predicted transitions from WT cells to DAA in AD. The expression level across clusters (dot color) and the percent of cells expressing (dot size) significant (Pearson Correlation coefficient, FDR qvalue<0.001, n=28 mice, 25,076 cells, Supplementary Table 1 ) genes that correlated with the transition to cluster 3 (intermediate) or cluster 4 (DAAs) from WT cells. Bottom: Assignment of each gene to a transition between pairs of clusters (upregulated = purple, downregulated = orange). ( f ) Direction of transition on the diffusion space of AD astrocytes in each cluster from their weighted K-nearest neighbor position among all other WT cells. Force field showing the directionality of transitions between the expected position in the diffusion map (weighted average position of K-NN among all WT cells, k=10) to the true position along the diffusion map (as in Figure 1d ) for each cell. Colored by cluster IDs. Cluster numbers labeled on top of each graph.

( a-b ) Diversity of human astrocytes. 2-D tSNE embedding of 3,392 sNuc-Seq profiles of cortical human astrocytes from post-mortem aging brains of AD and non-AD individuals, taken from Mathys et al. 20 , colored by cluster ID (de novo clustering, clusters A-F, ( a )), or by predicted cluster IDs (clusters 1–6, by CCA 5 , 6 projections, ( b )) using as reference clusters of 7-month old mice (as in Fig. 1d ). ( c ) The average prediction scores (as color scale) and the percent of cells with score above 0 (as dot size) for the three major end-states mouse clusters (from Fig. 1d ), across the human astrocyte clusters (as in a, Mathys et al. 20 ). From left to right: Gfap-low (mouse cluster 1), DAAs (mouse cluster 4), and Gfap-high (mouse cluster 6). ( d ) Dot plot showing the expression level (as color scale) and the percent of cells expressing (as dot size) marker genes for mouse astrocyte states: DAA (OSMR, VIM, GFAP), Gfap-high (ID1, ID3, SLC38A1, GFAP) and homeostatic Gfap-low (MFGE8), across clusters of the human cortical astrocytes (from Mathys et al. 20 ).